
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CJB - Hexo</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="Update��2022-10-21 20:57:20 ���������� 12 �����С����
Update��2022-10-23 22:06:30 ���������� 14��

Ī,"> 
    <meta name="author" content="John Doe"> 
    <link rel="alternative" href="atom.xml" title="Hexo" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="CJB - Hexo"/>
    <meta name="twitter:description" content="Update��2022-10-21 20:57:20 ���������� 12 �����С����
Update��2022-10-23 22:06:30 ���������� 14��

Ī,"/>
    
    
    
    
    <meta property="og:site_name" content="Hexo"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="CJB - Hexo"/>
    <meta property="og:description" content="Update��2022-10-21 20:57:20 ���������� 12 �����С����
Update��2022-10-23 22:06:30 ���������� 14��

Ī,"/>
    
<link rel="stylesheet" href="/css/diaspora.css">

    <script>window.searchDbPath = "/search.xml";</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet">
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="loading">
    <span id="config-title" style="display:none">Hexo</span>
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="iconfont icon-home image-icon" href="javascript:;" data-url="http://example.com"></a>
    <div title="播放/暂停" class="iconfont icon-play"></div>
    <h3 class="subtitle">CJB</h3>
    <div class="social">
        <div>
            <div class="share">
                <a title="获取二维码" class="iconfont icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>

    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">CJB</h1>
        <div class="stuff">
            <span>十月 26, 2022</span>
            

        </div>
        <div class="content markdown">
            <p>Update��2022-10-21 20:57:20 ���������� 12 �����С����</p>
<p>Update��2022-10-23 22:06:30 ���������� 14��</p>
<hr>
<h1 id="I����˹����"><a href="#I����˹����" class="headerlink" title="Ī����˹����"></a>Ī����˹����</h1><h2 id="���Ժ���"><a href="#���Ժ���" class="headerlink" title="���Ժ���"></a>���Ժ���</h2><p>$$<br>\begin{aligned}<br>\mu&amp;:\mu(n)&#x3D;<br>\begin{cases}<br>1&amp;n&#x3D;1\<br>0&amp;\text{n����ƽ������}\<br>(-1)^k&amp;\text{kΪ���ʲ�ͬ�������Ӹ���}\<br>\end{cases}\<br>\tau&amp;:\tau(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[i\mid n]\<br>\sigma&amp;:\sigma&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[i\mid n]i\<br>\varphi&amp;:\varphi(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[\gcd(i,n)&#x3D;1]\<br>1&amp;:1(n)&#x3D;1\<br>\varepsilon&amp;:\varepsilon(n)&#x3D;[n&#x3D;1]\<br>\operatorname{id}&amp;:\operatorname{id}(n)&#x3D;n\<br>\operatorname{id}&amp;:\operatorname{id_k}(n)&#x3D;n^k<br>\end{aligned}<br>$$</p>
<h2 id="���۷ֿ�"><a href="#���۷ֿ�" class="headerlink" title="���۷ֿ�"></a>���۷ֿ�</h2><h3 id="��Ԫ���۷ֿ�"><a href="#��Ԫ���۷ֿ�" class="headerlink" title="��Ԫ���۷ֿ�"></a>��Ԫ���۷ֿ�</h3><p>�������������ʽ��ʽ�ӣ�</p>
<p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\lfloor\frac{n}{i}\rfloor<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    r = n / (n / l);</span><br><span class="line">    \\doing something.</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * (n / l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="��Ԫ���۷ֿ�-1"><a href="#��Ԫ���۷ֿ�-1" class="headerlink" title="��Ԫ���۷ֿ�"></a>��Ԫ���۷ֿ�</h3><p>�������������ʽ��ʽ�ӣ�</p>
<p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\lfloor\frac{n}{i}\rfloor\lfloor\frac{m}{i}\rfloor<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">    \\doing something.</span><br><span class="line">    ans += (r - l + <span class="number">1</span>) * (n / l) * (m / l);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="�������׾���"><a href="#�������׾���" class="headerlink" title="�������׾���"></a>�������׾���</h2><h3 id="����"><a href="#����" class="headerlink" title="����"></a>����</h3><p>$$<br>(f*g)(n)&#x3D;\displaystyle\sum_{xy&#x3D;n}f(x)*g(x)<br>$$</p>
<p>�ȼ��ڣ�</p>
<p>$$<br>(f*g)(n)&#x3D;\displaystyle\sum_{x\mid n}f(x)*g(\frac{n}{x})<br>$$</p>
<h3 id="��Ҫ����"><a href="#��Ҫ����" class="headerlink" title="��Ҫ����"></a>��Ҫ����</h3><p>$$<br>\begin{aligned}<br>1<em>1&amp;&#x3D;\tau\<br>\mu</em>1&amp;&#x3D;\varepsilon\<br>\varphi*1&amp;&#x3D;\operatorname{id}\<br>\operatorname{id}<em>\mu&amp;&#x3D;\varphi\<br>\mu</em>\tau&amp;&#x3D;1\<br>\end{aligned}<br>$$</p>
<h3 id="�������׾���-1"><a href="#�������׾���-1" class="headerlink" title="�������׾���"></a>�������׾���</h3><p>���� $f(n)$ ��֪��$g(n)$ δ֪��</p>
<h4 id="��������j׺��"><a href="#��������j׺��" class="headerlink" title="��������ǰ׺��"></a>��������ǰ׺��</h4><p>$$<br>g(n)&#x3D;\displaystyle\sum_{d\mid n}f(d)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(prime:begin-&gt;end)</span><br><span class="line">    <span class="keyword">for</span>(k:<span class="number">1</span>-&gt;n/prime)</span><br><span class="line">        g[i*prime]+=g[i];</span><br></pre></td></tr></table></figure>

<h4 id="�������׺�׺��"><a href="#�������׺�׺��" class="headerlink" title="�������׺�׺��"></a>�������׺�׺��</h4><p>$$<br>g(n)&#x3D;\displaystyle\sum_{n\mid d}f(d)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(prime:begin-&gt;end)</span><br><span class="line">    <span class="keyword">for</span>(k:n/prime-&gt;<span class="number">1</span>)</span><br><span class="line">        g[i]+=g[i*prime];</span><br></pre></td></tr></table></figure>

<h4 id="���������j׺��"><a href="#���������j׺��" class="headerlink" title="���������ǰ׺��"></a>���������ǰ׺��</h4><p>$$<br>f(n)&#x3D;\displaystyle\sum_{d\mid n}g(d)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(prime:end-&gt;begin)</span><br><span class="line">    <span class="keyword">for</span>(k:n/prime-&gt;<span class="number">1</span>)</span><br><span class="line">        g[i*prime]-=g[i];</span><br></pre></td></tr></table></figure>

<h4 id="��������׺�׺��"><a href="#��������׺�׺��" class="headerlink" title="��������׺�׺��"></a>��������׺�׺��</h4><p>$$<br>f(n)&#x3D;\displaystyle\sum_{n\mid d}g(d)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(prime:end-&gt;begin)</span><br><span class="line">    <span class="keyword">for</span>(k:<span class="number">1</span>-&gt;n/prime)</span><br><span class="line">        g[i]-=g[i*prime];</span><br></pre></td></tr></table></figure>

<h2 id="I����˹����-1"><a href="#I����˹����-1" class="headerlink" title="Ī����˹����"></a>Ī����˹����</h2><h3 id="����-1"><a href="#����-1" class="headerlink" title="����"></a>����</h3><p>$$<br>\mu(n)&#x3D;<br>\begin{cases}<br>1&amp;n&#x3D;1\<br>0&amp;\text{n����ƽ������}\<br>(-1)^k&amp;\text{kΪ���ʲ�ͬ�������Ӹ���}\<br>\end{cases}<br>$$</p>
<h3 id="����-2"><a href="#����-2" class="headerlink" title="����"></a>����</h3><p>$(\mu*1)(n)&#x3D;\varepsilon(n)&#x3D;\displaystyle\sum_{d\mid n}\mu(d)&#x3D;[n&#x3D;1]$</p>
<p>$$<br>\displaystyle\sum_{d\mid n}\mu(d)&#x3D;<br>\begin{cases}<br>1&amp;n&#x3D;1\<br>0&amp;n\not&#x3D;1\<br>\end{cases}<br>$$</p>
<h3 id="����ɸ-mu"><a href="#����ɸ-mu" class="headerlink" title="����ɸ $\mu$"></a>����ɸ $\mu$</h3><p>$$<br>\begin{cases}<br>i&#x3D;1&amp;\mu(i)&#x3D;1\<br>i\in prime&amp;\mu(i)&#x3D;-1\<br>i\notin prime\land prime\mid i&amp;\mu(i<em>prime)&#x3D;0\<br>i\notin prime\land prime\nmid i&amp;\mu(i</em>prime)&#x3D;\mu(i)\times\mu(prime)&#x3D;-\mu(i)\<br>\end{cases}<br>$$</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = mu[i] * phi[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="y������"><a href="#y������" class="headerlink" title="ŷ������"></a>ŷ������</h2><h3 id="����-3"><a href="#����-3" class="headerlink" title="����"></a>����</h3><p>$\varphi(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[\gcd(i,n)&#x3D;1]$</p>
<h3 id="����-4"><a href="#����-4" class="headerlink" title="����"></a>����</h3><p>$(\varphi*1)(n)&#x3D;\operatorname{id}(n)&#x3D;\displaystyle\sum_{d\mid n}\varphi(d)&#x3D;n$</p>
<h3 id="����ɸ-varphi"><a href="#����ɸ-varphi" class="headerlink" title="����ɸ $\varphi$"></a>����ɸ $\varphi$</h3><p>$$<br>\begin{cases}<br>i&#x3D;1&amp;\varphi(i)&#x3D;1\<br>i\in prime&amp;\varphi(i)&#x3D;i-1\<br>prime\mid i&amp;\varphi(i<em>prime)&#x3D;\varphi(i)\times prime\<br>prime\nmid i&amp;\varphi(i</em>prime)&#x3D;\varphi(i)\times \varphi(prime)&#x3D;\varphi(i)\times (prime-1)\<br>\end{cases}<br>$$</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            phi[i * p[j]] = phi[i] * phi[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Լ������"><a href="#Լ������" class="headerlink" title="Լ������"></a>Լ������</h2><h3 id="����-5"><a href="#����-5" class="headerlink" title="����"></a>����</h3><p>$\tau(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[i\mid n]$</p>
<h3 id="����ɸ-tau"><a href="#����ɸ-tau" class="headerlink" title="����ɸ $\tau$"></a>����ɸ $\tau$</h3><p>$$<br>\begin{aligned}<br>n&#x3D;\prod_{i&#x3D;1}p_i^{k_i}\<br>\tau(n)&#x3D;\prod_{i&#x3D;1}(k_i+1)<br>\end{aligned}<br>$$</p>
<p>�� $\tau$ Ϊ $f$����Ҫ��������Ϊ $g$��</p>
<p>�� $g(n)$ Ϊ $n$ ��С�����ӵĴ��ݡ�</p>
<p>$$<br>\begin{cases}<br>i\in prime&amp;g(i)&#x3D;1\<br>prime\mid i&amp;g(i<em>prime)&#x3D;g(i)+1\<br>prime\nmid i&amp;g(i</em>prime)&#x3D;1\<br>\end{cases}<br>$$</p>
<p>$$<br>\begin{cases}<br>i&#x3D;1&amp;f(i)&#x3D;1\<br>i\in prime&amp;f(i)&#x3D;2\<br>prime\mid i&amp;f(i<em>prime)&#x3D;\frac{f(i)</em>(g(i<em>prime)+1)}{g(i)+1}\<br>prime\nmid i&amp;f(i</em>prime)&#x3D;f(i)<em>f(prime)&#x3D;2</em>f(i)\<br>\end{cases}<br>$$</p>
<h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    g[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            g[i] = <span class="number">1</span>;</span><br><span class="line">            f[i] = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i * p[j]] = g[i] + <span class="number">1</span>;</span><br><span class="line">                f[i * p[j]] = f[i] / (g[i] + <span class="number">1</span>) * (g[i * p[j]] + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            g[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Լ����"><a href="#Լ����" class="headerlink" title="Լ����"></a>Լ����</h2><h3 id="����-6"><a href="#����-6" class="headerlink" title="����"></a>����</h3><p>$$<br>\sigma&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[i\mid n]i<br>$$</p>
<h3 id="����ɸ-sigma"><a href="#����ɸ-sigma" class="headerlink" title="����ɸ $\sigma$"></a>����ɸ $\sigma$</h3><p>$$<br>\begin{aligned}<br>n&#x3D;\prod_{i&#x3D;1}p_i^{k_i}\<br>\sigma(n)&#x3D;\prod_{i&#x3D;1}\displaystyle\sum_{j&#x3D;0}^{k_i}p_i^j<br>\end{aligned}<br>$$</p>
<p>�� $\sigma$ Ϊ $f$����Ҫ��������Ϊ $g$��</p>
<p>�� $g(n)$ Ϊ $\displaystyle\sum_{i&#x3D;0}p^i$��$p$ Ϊ $n$ ����С�����ӡ�</p>
<p>$$<br>\begin{cases}<br>i\in prime&amp;g(i)&#x3D;i+1\<br>prime\mid i&amp;g(i*prime)&#x3D;g(i)<em>prime+1\<br>prime\nmid i&amp;g(i</em>prime)&#x3D;prime+1\<br>\end{cases}<br>$$</p>
<p>$$<br>\begin{cases}<br>i&#x3D;1&amp;f(i)&#x3D;1\<br>i\in prime&amp;f(i)&#x3D;i+1\<br>prime\mid i&amp;f(i<em>prime)&#x3D;\frac{f(i)<em>g(i</em>prime)}{g(i)}\<br>prime\nmid i&amp;f(i</em>prime)&#x3D;f(i)*f(prime)&#x3D;(prime+1)*f(i)\<br>\end{cases}<br>$$</p>
<h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    g[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            g[i] = i + <span class="number">1</span>;</span><br><span class="line">            f[i] = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i * p[j]] = g[i] * p[j] + <span class="number">1</span>;</span><br><span class="line">                f[i * p[j]] = f[i] / g[i] * g[i * p[j]];</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            g[i * p[j]] = p[j] + <span class="number">1</span>;</span><br><span class="line">            f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="��A���"><a href="#��A���" class="headerlink" title="��Ⱥ���"></a>��Ⱥ���</h2><h3 id="����-7"><a href="#����-7" class="headerlink" title="����"></a>����</h3><p>$$<br>\begin{aligned}<br>\operatorname{id}(n)&amp;&#x3D;n\<br>\operatorname{id_k}(n)&amp;&#x3D;n^k<br>\end{aligned}<br>$$</p>
<h3 id="����ɸ-operatorname-id-k"><a href="#����ɸ-operatorname-id-k" class="headerlink" title="����ɸ $\operatorname{id_k}$"></a>����ɸ $\operatorname{id_k}$</h3><p>$$<br>\begin{cases}<br>i&#x3D;1&amp;\operatorname{id_k}(i)&#x3D;1\<br>i\in prime&amp;\operatorname{id_k}(i)&#x3D;i^k\<br>prime\mid i&amp;\operatorname{id_k}(i*prime)&#x3D;\operatorname{id_k}(i)<em>\operatorname{id_k}(prime)\<br>prime\nmid i&amp;\operatorname{id_k}(i</em>prime)&#x3D;\operatorname{id_k}(i)*\operatorname{id_k}(prime)\<br>\end{cases}<br>$$</p>
<h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    idk[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            idk[i] = <span class="built_in">pow</span>(i, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            idk[i * p[j]] = idk[i] * idk[p[j]];</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="I����˹����-2"><a href="#I����˹����-2" class="headerlink" title="Ī����˹����"></a>Ī����˹����</h2><h3 id="���ݽ���"><a href="#���ݽ���" class="headerlink" title="���ݽ���"></a>���ݽ���</h3><p>$\displaystyle\sum_{d\mid\gcd(i,j)}\mu(d)&#x3D;[\gcd(i,j)&#x3D;1]$</p>
<h3 id="֤����"><a href="#֤����" class="headerlink" title="֤����"></a>֤����</h3><p>$$<br>\begin{aligned}<br>(\mu*1)(\gcd(i,j))<br>&amp;&#x3D;\displaystyle\sum_{d\mid\gcd(i,j)}\mu(d)\<br>&amp;&#x3D;\varepsilon(\gcd(i,j))\<br>&amp;&#x3D;[\gcd(i,j)&#x3D;1]<br>\end{aligned}<br>$$</p>
<h2 id="y������-1"><a href="#y������-1" class="headerlink" title="ŷ������"></a>ŷ������</h2><h3 id="���ݽ���-1"><a href="#���ݽ���-1" class="headerlink" title="���ݽ���"></a>���ݽ���</h3><p>$\displaystyle\sum_{d\mid \gcd(i,j)}\varphi(d)&#x3D;\gcd(i,j)$</p>
<h3 id="֤����-1"><a href="#֤����-1" class="headerlink" title="֤����"></a>֤����</h3><p>$$<br>\begin{aligned}<br>(\varphi*1)(\gcd(i,j))<br>&amp;&#x3D;\displaystyle\sum_{d\mid \gcd(i,j)}\varphi(d)\<br>&amp;&#x3D;\operatorname{id}(\gcd(i,j))\<br>&amp;&#x3D;\gcd(i,j)<br>\end{aligned}<br>$$</p>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><h3 id="j��"><a href="#j��" class="headerlink" title="ǰ��"></a>ǰ��</h3><p>����֤����֤ $n\lt m$��</p>
<h3 id="Question-0"><a href="#Question-0" class="headerlink" title="Question 0"></a>Question 0</h3><h4 id="��L"><a href="#��L" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;1]<br>$$</p>
<h4 id="֤��"><a href="#֤��" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;1]<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid\gcd(i,j)}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid i\land d\mid j}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{n}[d\mid i]\displaystyle\sum_{j&#x3D;1}^{m}[d\mid j]\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\lfloor\frac{n}{d}\rfloor\lfloor\frac{m}{d}\rfloor<br>\end{aligned}<br>$$</p>
<p>ֱ������ɸ $\mu$�����۷ֿ�ͺ��ˡ�˳����һ�£�ԭ��Ŀ�� $\gcd(n,0)&#x3D;n$��</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-1"><a href="#Question-1" class="headerlink" title="Question 1"></a>Question 1</h3><h4 id="��L-1"><a href="#��L-1" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;k]<br>$$</p>
<h4 id="֤��-1"><a href="#֤��-1" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;k]<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}[k\mid i]\displaystyle\sum_{j&#x3D;1}^{m}[k\mid j][\gcd(\frac{i}{k},\frac{j}{k})&#x3D;\frac{k}{k}]\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{k}\rfloor}[\gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{k}\rfloor}\displaystyle\sum_{d\mid \gcd(i,j)}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}[d\mid i]\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{k}\rfloor}[d\mid j]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{kd}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{kd}\rfloor}1\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\lfloor\frac{n}{kd}\rfloor\lfloor\frac{m}{kd}\rfloor\<br>\end{aligned}<br>$$</p>
<p>��������ʽ�ӿ��Զ�Ԫ���۷ֿ飬Ԥ���� $\mu$ ��ǰ׺�͡�</p>
<h4 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, k, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    n /= k, m /= k;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-2"><a href="#Question-2" class="headerlink" title="Question 2"></a>Question 2</h3><h4 id="��L-2"><a href="#��L-2" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)\in prime]<br>$$</p>
<h4 id="֤��-2"><a href="#֤��-2" class="headerlink" title="֤��"></a>֤��</h4><p>�̳� $\operatorname{Problem 1}$ �Ľ��ۣ�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)\in prime]<br>&amp;&#x3D;\displaystyle\sum_{k\in prime}\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;k]\<br>&amp;&#x3D;\displaystyle\sum_{k\in prime}\displaystyle\sum_{d&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\lfloor\frac{n}{kd}\rfloor\lfloor\frac{m}{kd}\rfloor<br>\end{aligned}<br>$$</p>
<p>Err��ʽ���Ƶ����ﻹ���У�$\operatorname{TLE}$������Ҫ���������</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{k\in prime}\displaystyle\sum_{d&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\lfloor\frac{n}{kd}\rfloor\lfloor\frac{m}{kd}\rfloor<br>&amp;&#x3D;\displaystyle\sum_{k\in prime}\displaystyle\sum_{d&#x3D;1}^{\lfloor\frac{n}{k}\rfloor}\mu(d)\lfloor\frac{n}{T}\rfloor\lfloor\frac{m}{T}\rfloor\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{n}\lfloor\frac{n}{T}\rfloor\lfloor\frac{m}{T}\rfloor\displaystyle\sum_{k\mid T\land k\in prime}\mu(\frac{T}{k})<br>\end{aligned}<br>$$</p>
<p>�������һ����ô���ģ���ȻҪ�� $T&#x3D;kd$ �������Ϊö����� $k\mid T$ ʱ��$d&#x3D;\frac{T}{k}$�����Ծͻ�Ϊ�����ʽ�ӡ�</p>
<p>���ʽ�ӿ���ֱ��Ԥ������ $\displaystyle\sum_{k\mid T\land k\in prime}\mu(\frac{T}{k})$��ֻ��Ҫö��ÿ������ $k$ �ı��������ˣ�Ȼ��Ϳ��Զ�Ԫ���۷ֿ顣</p>
<h4 id="Code-6"><a href="#Code-6" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k : p)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> d = <span class="number">1</span>; d * k &lt;= n; d++)</span><br><span class="line">            sum[d * k] += mu[d];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-3"><a href="#Question-3" class="headerlink" title="Question 3"></a>Question 3</h3><h4 id="��L-3"><a href="#��L-3" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;a}^{b}\displaystyle\sum_{j&#x3D;c}^{d}[\gcd(i,j)&#x3D;k]<br>$$</p>
<h4 id="֤��-3"><a href="#֤��-3" class="headerlink" title="֤��"></a>֤��</h4><p>��Ҫ˵��β���� $\sum$��Ȼ����� $\operatorname{Problem 1}$ �ˣ�Ϊ�˷�����д��ֻ������β� $\sum$��֤��ʡȥ������������</p>
<p>�� $f(n,m)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\operatorname{limit}]$��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;a}^{b}\displaystyle\sum_{j&#x3D;c}^{d}<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;a}^{b}\displaystyle\sum_{j&#x3D;1}^{d}-\displaystyle\sum_{i&#x3D;a}^{b}\displaystyle\sum_{j&#x3D;1}^{c-1}\<br>&amp;&#x3D;(\displaystyle\sum_{i&#x3D;1}^{b}\displaystyle\sum_{j&#x3D;1}^{d}-\displaystyle\sum_{i&#x3D;1}^{a-1}\displaystyle\sum_{j&#x3D;1}^{d})-(\displaystyle\sum_{i&#x3D;1}^{b}\displaystyle\sum_{j&#x3D;1}^{c-1}-\displaystyle\sum_{i&#x3D;1}^{a-1}\displaystyle\sum_{j&#x3D;1}^{c-1})\<br>&amp;&#x3D;(f(b,d)-f(a-1,d))-(f(b,c-1)-f(a-1,c-1))\<br>\end{aligned}<br>$$</p>
<p>Ȼ��� $f(n,m)$ ���� $\operatorname{Problem 1}$ �ͽ���ˡ�</p>
<h4 id="Code-7"><a href="#Code-7" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> a, b, c, d, k;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    n /= k, m /= k;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m)</span><br><span class="line">        <span class="built_in">swap</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d &gt;&gt; k;</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="built_in">max</span>(b / k, d / k));</span><br><span class="line">    <span class="built_in">initival</span>(<span class="built_in">max</span>(b / k, d / k));</span><br><span class="line">    cout &lt;&lt; (<span class="built_in">f</span>(b, d) - <span class="built_in">f</span>(a - <span class="number">1</span>, d)) - (<span class="built_in">f</span>(b, c - <span class="number">1</span>) - <span class="built_in">f</span>(a - <span class="number">1</span>, c - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-4"><a href="#Question-4" class="headerlink" title="Question 4"></a>Question 4</h3><h4 id="��L-4"><a href="#��L-4" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\gcd(i,j)<br>$$</p>
<h4 id="֤��-4"><a href="#֤��-4" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\gcd(i,j)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid \gcd(i,j)}\varphi(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\varphi(d)\displaystyle\sum_{i&#x3D;1}^{n}[d\mid i]\displaystyle\sum_{j&#x3D;1}^{m}[d\mid j]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\varphi(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}1\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\varphi(d)\lfloor\frac{n}{d}\rfloor\lfloor\frac{m}{d}\rfloor\<br>\end{aligned}<br>$$</p>
<p>���ָ� $\operatorname{Problem 1}$ ���𲻴�ֻ�ǽ� $\mu$ ��Ϊ�� $\varphi$����Ȼ��Ԫ���۷ֿ��Ԥ����ǰ׺�͡�</p>
<h4 id="Code-8"><a href="#Code-8" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> phi[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            phi[i * p[j]] = phi[i] * (p[j] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + phi[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-5"><a href="#Question-5" class="headerlink" title="Question 5"></a>Question 5</h3><h4 id="��L-5"><a href="#��L-5" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\operatorname{lcm(i,j)}<br>$$</p>
<h4 id="֤��-5"><a href="#֤��-5" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\operatorname{lcm(i,j)}<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\frac{ij}{\gcd(i,j)}\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid i\land d\mid j}[\gcd(\frac{i}{d},\frac{j}{d})&#x3D;1]\frac{ij}{d}\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(\frac{id}{d},\frac{jd}{d})&#x3D;1]\frac{id\times jd}{d}\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]ij\<br>\end{aligned}<br>$$</p>
<p>�� $f(n,m)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}ij$�����ֺ�벿�ֿ��� $O(1)$ ��</p>
<p>$$<br>\begin{aligned}<br>f(n,m)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}ij\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}i\times\displaystyle\sum_{j&#x3D;1}^{m}j\<br>&amp;&#x3D;\frac{n\times(n+1)}{2}\times\frac{m\times(m+1)}{2}\<br>\end{aligned}<br>$$</p>
<p>�� $g(n,m)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;1]\times ij$��������һ���ֿ������۷ֿ飺</p>
<p>$$<br>\begin{aligned}<br>g(n,m)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;1]\times ij\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}1\times id\times jd\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)d^2\times f(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)<br>\end{aligned}<br>$$</p>
<p>���Ԫ���������۷ֿ������۷ֿ飺</p>
<p>$$<br>\displaystyle\sum_{d&#x3D;1}^{n}d\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]ij&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d\times g(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)<br>$$</p>
<h4 id="Code-9"><a href="#Code-9" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + i * i * mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span> <span class="comment">// �Ȳ��������</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x + y) * (y - x + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> <span class="comment">// ֤���е� f ����</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">h</span>(<span class="number">1</span>, n) * <span class="built_in">h</span>(<span class="number">1</span>, m);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> <span class="comment">// ֤���е� g ����</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m)</span><br><span class="line">        <span class="built_in">swap</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * <span class="built_in">f</span>(n / l, m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += <span class="built_in">h</span>(l, r) * <span class="built_in">g</span>(n / l, m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-6"><a href="#Question-6" class="headerlink" title="Question 6"></a>Question 6</h3><h4 id="��L-6"><a href="#��L-6" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(ij)<br>$$</p>
<p>$\tau(n)$ Ϊ $n$ ��Լ��������</p>
<h4 id="֤��-6"><a href="#֤��-6" class="headerlink" title="֤��"></a>֤��</h4><p>ǰ�ã�</p>
<p><del>˵���ˣ��Ҳ���д���ǰ�õ�֤����</del></p>
<p>$$<br>\alpha(ij)&#x3D;\displaystyle\sum_{x\mid i}\displaystyle\sum_{y\mid j}[\gcd(x,y)&#x3D;1]<br>$$</p>
<p>���Ĵ��룺</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\alpha(ij)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{x\mid i}\displaystyle\sum_{y\mid j}[\gcd(x,y)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{x\mid i}\displaystyle\sum_{y\mid j}\displaystyle\sum_{d\mid \gcd(x,y)}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{x&#x3D;1}^{i}[x\mid i]\displaystyle\sum_{y&#x3D;1}^{j}[y\mid j][d\mid \gcd(x,y)]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{x&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{n}[x\mid i]\displaystyle\sum_{y&#x3D;1}^{m}\displaystyle\sum_{j&#x3D;1}^{m}[y\mid j][d\mid \gcd(x,y)]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{x&#x3D;1}^{n}\displaystyle\sum_{y&#x3D;1}^{m}[d\mid \gcd(x,y)]\lfloor\frac{n}{x}\rfloor\lfloor\frac{m}{y}\rfloor\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{x&#x3D;1}^{n}[d\mid x]\displaystyle\sum_{y&#x3D;1}^{m}[d\mid y]\lfloor\frac{n}{x}\rfloor\lfloor\frac{m}{y}\rfloor\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{x&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{y&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\lfloor\frac{n}{xd}\rfloor\lfloor\frac{m}{yd}\rfloor\<br>\end{aligned}<br>$$</p>
<p>�� $f(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\lfloor\frac{n}{i}\rfloor$</p>
<p>��Ԫ���룺</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{x&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{y&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\lfloor\frac{n}{xd}\rfloor\lfloor\frac{m}{yd}\rfloor<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)f(\lfloor\frac{n}{d}\rfloor)f(\lfloor\frac{m}{d}\rfloor)<br>\end{aligned}<br>$$</p>
<p>���۷ֿ�ͺ��ˣ����� $f$ �����������ʱ�˿��Լ��仯����Ϊ $n\leqslant 50000$��</p>
<h4 id="Code-10"><a href="#Code-10" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans += (r - l + <span class="number">1</span>) * (n / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * <span class="built_in">f</span>(n / l) * <span class="built_in">f</span>(m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-7"><a href="#Question-7" class="headerlink" title="Question 7"></a>Question 7</h3><h4 id="��L-7"><a href="#��L-7" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>(\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}ij\gcd(i,j))\bmod,p<br>$$</p>
<p>$n\leqslant 10^{10}$��ע�����ݷ�Χ</p>
<h4 id="֤��-7"><a href="#֤��-7" class="headerlink" title="֤��"></a>֤��</h4><p>Ϊ��֤�����㣬��ȥȡģ��</p>
<h5 id="j��-1"><a href="#j��-1" class="headerlink" title="ǰ��"></a>ǰ��</h5><p>һЩ��Ȼ��ʽ�ӣ�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}i&amp;&#x3D;\frac{n\times(n+1)}{2}\<br>\displaystyle\sum_{i&#x3D;1}^{n}i^2&amp;&#x3D;\frac{n\times(n+1)\times(2\times n+1)}{6}\<br>\displaystyle\sum_{i&#x3D;1}^{n}i^3&amp;&#x3D;\frac{n^2\times(n+1)^2}{4}\<br>\end{aligned}<br>$$</p>
<p>�Ž�ɸ��</p>
<p>�� $f(n)$ ΪҪ��ĺ�����$g(n)$ Ϊ��������ĺ�����$S(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}f(i)$��</p>
<p>֤����</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}(f*g)(i)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{d\mid i}f(d)*g(\frac{n}{d})\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{d\mid i}f(\frac{n}{d})*g(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{n}[d\mid i]f(\frac{i}{d})*g(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}g(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}f(\frac{i\times d}{d})\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}g(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}f(i)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}g(d)S(\lfloor\frac{n}{d}\rfloor)\<br>\end{aligned}<br>$$</p>
<p>Ȼ���� $g(1)S(n)$ �����</p>
<p>$$<br>\begin{aligned}<br>g(1)S(n)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}g(i)S(\lfloor\frac{n}{i}\rfloor)-\displaystyle\sum_{i&#x3D;2}^{n}g(i)S(\lfloor\frac{n}{i}\rfloor)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}(f*g)(i)-\displaystyle\sum_{i&#x3D;2}^{n}g(i)S(\lfloor\frac{n}{i}\rfloor)<br>\end{aligned}<br>$$</p>
<p>����ͨʽ��</p>
<p>$$<br>g(1)S(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}(f*g)(i)-\displaystyle\sum_{i&#x3D;2}^{n}g(i)\times S(\lfloor\frac{n}{i}\rfloor)<br>$$</p>
<h5 id="mu-����"><a href="#mu-����" class="headerlink" title="$\mu$ ����"></a>$\mu$ ����</h5><p>��� $\operatorname{Problem 5}$��ֱ�ӽ� $\gcd(i,j)$ �滻��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}ij\gcd(i,j)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}ij\displaystyle\sum_{d\mid i\land d\mid j}d[\gcd(i,j)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}ij[\gcd(i,j)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d\displaystyle\sum_{i&#x3D;1}^{n}[d\mid i]\displaystyle\sum_{j&#x3D;1}^{n}[d\mid j]ij[\gcd(i,j)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}id\times jd[\gcd(id,jd)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^3\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}[\gcd(i,j)&#x3D;1]\times ij<br>\end{aligned}<br>$$</p>
<p>$f,g$ ֤��ͬ $\operatorname{Problem 5}$������׸����Ȼ����Ȼ�裺</p>
<p>$f(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}ij&#x3D;(\frac{n\times(n+1)}{2})^2$��</p>
<p>$g(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}[\gcd(i,j)&#x3D;1]\times ij&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)d^2\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}ij&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)d^2\times f(\lfloor\frac{n}{d}\rfloor)$��</p>
<p>���Ԫ��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{d&#x3D;1}^{n}d^3\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}[\gcd(i,j)&#x3D;1]\times ij<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^3\times g(\lfloor\frac{n}{d}\rfloor)<br>\end{aligned}<br>$$</p>
<p>����֤����һ���֣��Ž�ɸ��</p>
<p>���� $\mu$ ���ݵ�֤����ƿ������ $\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)d^2$������ $n$ �ܴ��޷�����ɸ�����ǶŽ�ɸ��</p>
<p>�裺</p>
<p>$$<br>\begin{aligned}<br>f(n)&amp;&#x3D;n^2\mu(n)\<br>g(n)&amp;&#x3D;n^2\<br>S(n)&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}f(i)\<br>g(1)&amp;&#x3D;1^2&#x3D;1\<br>\end{aligned}<br>$$</p>
<p>���� $(f*g)(n)$</p>
<p>$$<br>\begin{aligned}<br>(f*g)(n)<br>&amp;&#x3D;\displaystyle\sum_{d\mid n}f(d)<em>g(\frac{n}{d})\<br>&amp;&#x3D;\displaystyle\sum_{d\mid n}d^2\mu(d)\times \frac{n^2}{d^2}\<br>&amp;&#x3D;n^2\displaystyle\sum_{d\mid n}\mu(d)\<br>&amp;&#x3D;n^2(\mu</em>1)(n)\<br>&amp;&#x3D;n^2\varepsilon(n)\<br>\end{aligned}<br>$$</p>
<p>����ͨʽ��</p>
<p>$$<br>S(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}i^2\varepsilon(i)-\displaystyle\sum_{i&#x3D;2}^{n}i^2\times S(\lfloor\frac{n}{i}\rfloor)&#x3D;1-\displaystyle\sum_{i&#x3D;2}^{n}i^2\times S(\lfloor\frac{n}{i}\rfloor)<br>$$</p>
<p>��ʱ���� $S(n)$ �����öŽ�ɸ���۷ֿ����ˡ�</p>
<p>Ȼ���ܲ��ң����϶Ž�ɸ��ʱ�临�Ӷ�̫�ߣ�����ͨ����</p>
<h5 id="varphi-����"><a href="#varphi-����" class="headerlink" title="$\varphi$ ����"></a>$\varphi$ ����</h5><p>���� $\displaystyle\sum_{d\mid \gcd(i,j)}\varphi(d)&#x3D;\gcd(i,j)$ ֱ���滻��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}ij\gcd(i,j)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}\displaystyle\sum_{d\mid \gcd(i,j)}\varphi(d)ij\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\varphi(d)id\times jd\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^2\varphi(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}ij\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^2\varphi(d)\times f(\lfloor\frac{n}{d}\rfloor)<br>\end{aligned}<br>$$</p>
<p>ͬ����ƿ������ $\displaystyle\sum_{d&#x3D;1}^{n}d^2\varphi(d)$�����ǶŽ�ɸ��</p>
<p>�裺</p>
<p>$$<br>\begin{aligned}<br>f(n)&amp;&#x3D;n^2\varphi(n)\<br>g(n)&amp;&#x3D;n^2\<br>S(n)&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}f(i)\<br>g(1)&amp;&#x3D;1^2&#x3D;1\<br>\end{aligned}<br>$$</p>
<p>���� $(f*g)(n)$</p>
<p>$$<br>\begin{aligned}<br>(f*g)(n)<br>&amp;&#x3D;\displaystyle\sum_{d\mid n}f(d)<em>g(\frac{n}{d})\<br>&amp;&#x3D;\displaystyle\sum_{d\mid n}d^2\varphi(d)\times \frac{n^2}{d^2}\<br>&amp;&#x3D;n^2\displaystyle\sum_{d\mid n}\varphi(d)\<br>&amp;&#x3D;n^2(\varphi</em>1)(n)\<br>&amp;&#x3D;n^2\operatorname{id}(n)\<br>&amp;&#x3D;n^3\<br>\end{aligned}<br>$$</p>
<p>����ͨʽ��</p>
<p>$$<br>S(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}i^3-\displaystyle\sum_{i&#x3D;2}^{n}i^2\times S(\lfloor\frac{n}{i}\rfloor)&#x3D;\frac{n^2\times(n+1)^2}{4}-\displaystyle\sum_{i&#x3D;2}^{n}i^2\times S(\lfloor\frac{n}{i}\rfloor)<br>$$</p>
<p>�� $\mu$ ��࣬��ʱ���� $S(n)$ �����öŽ�ɸ���۷ֿ����ˡ�</p>
<h4 id="Code-11"><a href="#Code-11" class="headerlink" title="Code"></a>Code</h4><p>$\mu$ ���ݣ��ܲ��ң�һ���ֲ��Ե� $\operatorname{TLE}$ �ˣ�����˼·�ǶԵģ�ʱ�临�ӶȲ�̫�ԣ����۷ֿ������۷ֿ飬�ڲ����׸��Ž�ɸ��(555)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">int</span> inv2, inv4, inv6;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">bitset&lt;N&gt; vis;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line">ll n;</span><br><span class="line">unordered_map&lt;ll,<span class="type">int</span>&gt; mp;</span><br><span class="line"><span class="keyword">namespace</span> calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> MOD;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x+y&gt;=MOD?x+y-MOD:x+y;&#125; <span class="comment">// +</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x-y+MOD:x-y;&#125;      <span class="comment">// -</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> (ll)x*y%MOD;&#125;          <span class="comment">// *</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mod</span><span class="params">(ll x)</span></span>&#123;<span class="keyword">return</span> x&gt;=MOD?x%MOD:x;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Add</span>(<span class="built_in">Add</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Red</span>(<span class="built_in">Red</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ksm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> ans=<span class="number">1</span>)</span></span>&#123;<span class="keyword">while</span>(y&gt;<span class="number">0</span>)&#123;<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans=<span class="built_in">Mul</span>(ans,x);x=<span class="built_in">Mul</span>(x,x);y&gt;&gt;=<span class="number">1</span>;&#125;<span class="keyword">return</span> ans;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Inv</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Ksm</span>(x,MOD<span class="number">-2</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> calc;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; (ll)i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = <span class="built_in">Add</span>(sum[i - <span class="number">1</span>], <span class="built_in">Mul</span>(i, i, <span class="built_in">Add</span>(MOD, mu[i])));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h3</span><span class="params">(ll x, ll y)</span> <span class="comment">// [x-&gt;y](sum i^3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Red</span>(<span class="built_in">Mul</span>(<span class="built_in">Mod</span>(y), <span class="built_in">Mod</span>(y), <span class="built_in">Mod</span>(y + <span class="number">1</span>), <span class="built_in">Mod</span>(y + <span class="number">1</span>)), <span class="built_in">Mul</span>(<span class="built_in">Mod</span>(x), <span class="built_in">Mod</span>(x), <span class="built_in">Mod</span>(x - <span class="number">1</span>), <span class="built_in">Mod</span>(x - <span class="number">1</span>))), inv4);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h2</span><span class="params">(ll x, ll y)</span> <span class="comment">// [x-&gt;y](sum i^2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Red</span>(<span class="built_in">Mul</span>(<span class="built_in">Mod</span>(y), <span class="built_in">Mod</span>(y + <span class="number">1</span>), <span class="built_in">Mod</span>(<span class="number">2</span> * y + <span class="number">1</span>)), <span class="built_in">Mul</span>(<span class="built_in">Mod</span>(x - <span class="number">1</span>), <span class="built_in">Mod</span>(x), <span class="built_in">Mod</span>(<span class="number">2ll</span> * x - <span class="number">1</span>))), inv6);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h1</span><span class="params">(ll x, ll y)</span> <span class="comment">// [x-&gt;y](sum i^1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mod</span>(x + y), <span class="built_in">Mod</span>(y - x + <span class="number">1</span>), inv2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_sum</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; N)</span><br><span class="line">        <span class="keyword">return</span> sum[n];</span><br><span class="line">    <span class="keyword">if</span>(mp.<span class="built_in">count</span>(n))</span><br><span class="line">        <span class="keyword">return</span> mp[n];</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans = <span class="built_in">Red</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">h2</span>(l, r), <span class="built_in">get_sum</span>(n / l)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mp[n] = ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(ll n)</span> <span class="comment">// ֤���е� f ����</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">h1</span>(<span class="number">1</span>, n), <span class="built_in">h1</span>(<span class="number">1</span>, n));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">(ll n)</span> <span class="comment">// ֤���е� g ����</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans = <span class="built_in">Add</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">Red</span>(<span class="built_in">get_sum</span>(r), <span class="built_in">get_sum</span>(l - <span class="number">1</span>)), <span class="built_in">f</span>(n / l)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; MOD &gt;&gt; n;</span><br><span class="line">    inv2 = <span class="built_in">Inv</span>(<span class="number">2</span>);</span><br><span class="line">    inv4 = <span class="built_in">Inv</span>(<span class="number">4</span>);</span><br><span class="line">    inv6 = <span class="built_in">Inv</span>(<span class="number">6</span>);</span><br><span class="line">    <span class="built_in">Euler</span>(N - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">initival</span>(N - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans = <span class="built_in">Add</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">h3</span>(l, r), <span class="built_in">g</span>(n / l)));</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$\varphi$ ���ݣ�ʱ�临�Ӷ���ȷ��</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">int</span> inv2, inv4, inv6;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">bitset&lt;N&gt; vis;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="type">int</span> phi[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line">ll n;</span><br><span class="line">unordered_map&lt;ll, <span class="type">int</span>&gt; mp;</span><br><span class="line"><span class="keyword">namespace</span> calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> MOD;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x+y&gt;=MOD?x+y-MOD:x+y;&#125; <span class="comment">// +</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x-y+MOD:x-y;&#125;      <span class="comment">// -</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> (ll)x*y%MOD;&#125;          <span class="comment">// *</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mod</span><span class="params">(ll x)</span></span>&#123;<span class="keyword">return</span> x&gt;=MOD?x%MOD:x;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Add</span>(<span class="built_in">Add</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Red</span>(<span class="built_in">Red</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ksm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> ans=<span class="number">1</span>)</span></span>&#123;<span class="keyword">while</span>(y&gt;<span class="number">0</span>)&#123;<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans=<span class="built_in">Mul</span>(ans,x);x=<span class="built_in">Mul</span>(x,x);y&gt;&gt;=<span class="number">1</span>;&#125;<span class="keyword">return</span> ans;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Inv</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Ksm</span>(x,MOD<span class="number">-2</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> calc;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; (ll)i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            phi[i * p[j]] = phi[i] * (p[j] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = <span class="built_in">Add</span>(sum[i - <span class="number">1</span>], <span class="built_in">Mul</span>(i, i, <span class="built_in">Add</span>(MOD, phi[i])));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h3</span><span class="params">(ll x, ll y)</span> <span class="comment">// [x-&gt;y](sum i^3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Red</span>(<span class="built_in">Mul</span>(<span class="built_in">Mod</span>(y), <span class="built_in">Mod</span>(y), <span class="built_in">Mod</span>(y + <span class="number">1</span>), <span class="built_in">Mod</span>(y + <span class="number">1</span>)), <span class="built_in">Mul</span>(<span class="built_in">Mod</span>(x), <span class="built_in">Mod</span>(x), <span class="built_in">Mod</span>(x - <span class="number">1</span>), <span class="built_in">Mod</span>(x - <span class="number">1</span>))), inv4);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h2</span><span class="params">(ll x, ll y)</span> <span class="comment">// [x-&gt;y](sum i^2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Red</span>(<span class="built_in">Mul</span>(<span class="built_in">Mod</span>(y), <span class="built_in">Mod</span>(y + <span class="number">1</span>), <span class="built_in">Mod</span>(<span class="number">2</span> * y + <span class="number">1</span>)), <span class="built_in">Mul</span>(<span class="built_in">Mod</span>(x - <span class="number">1</span>), <span class="built_in">Mod</span>(x), <span class="built_in">Mod</span>(<span class="number">2ll</span> * x - <span class="number">1</span>))), inv6);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">h1</span><span class="params">(ll x, ll y)</span> <span class="comment">// [x-&gt;y](sum i^1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mod</span>(x + y), <span class="built_in">Mod</span>(y - x + <span class="number">1</span>), inv2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get_sum</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; N)</span><br><span class="line">        <span class="keyword">return</span> sum[n];</span><br><span class="line">    <span class="keyword">if</span> (mp.<span class="built_in">count</span>(n))</span><br><span class="line">        <span class="keyword">return</span> mp[n];</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">h3</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span> (ll l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans = <span class="built_in">Red</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">h2</span>(l, r), <span class="built_in">get_sum</span>(n / l)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mp[n] = ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; MOD &gt;&gt; n;</span><br><span class="line">    inv2 = <span class="built_in">Inv</span>(<span class="number">2</span>);</span><br><span class="line">    inv4 = <span class="built_in">Inv</span>(<span class="number">4</span>);</span><br><span class="line">    inv6 = <span class="built_in">Inv</span>(<span class="number">6</span>);</span><br><span class="line">    <span class="built_in">Euler</span>(N - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">initival</span>(N - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans = <span class="built_in">Add</span>(ans, <span class="built_in">Mul</span>(<span class="built_in">Red</span>(<span class="built_in">get_sum</span>(r), <span class="built_in">get_sum</span>(l - <span class="number">1</span>)), <span class="built_in">h3</span>(<span class="number">1</span>, n / l)));</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-8"><a href="#Question-8" class="headerlink" title="Question 8"></a>Question 8</h3><h4 id="��L-8"><a href="#��L-8" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\gcd(i,j)^k<br>$$</p>
<h4 id="֤��-8"><a href="#֤��-8" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\gcd(i,j)^k<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^k\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^k\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^k\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\displaystyle\sum_{s\mid \gcd(i,j)}\mu(s)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^k\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{ds}\rfloor\lfloor\frac{m}{ds}\rfloor\<br>\end{aligned}<br>$$</p>
<p>��Ԫ $T&#x3D;ds$ �� $\operatorname{Problem 2}$ ���ơ�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{d&#x3D;1}^{n}d^k\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{ds}\rfloor\lfloor\frac{m}{ds}\rfloor<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d^k\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{T}\rfloor\lfloor\frac{m}{T}\rfloor\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{n}\lfloor\frac{n}{T}\rfloor\lfloor\frac{m}{T}\rfloor\displaystyle\sum_{d\mid T}d^k\mu(\frac{T}{d})<br>\end{aligned}<br>$$</p>
<p>Ԥ������ö�� $d$ �ı���������ʱ�临�Ӷ� $\displaystyle\sum_{i&#x3D;1}^{n}\frac{n}{i}&#x3D;n\ln n,(n\leqslant 5\times 10^6)$��ʱ�临�Ӷ� $O(n\ln n)$ ���ܽ��ܡ�</p>
<p>������ο��ٴ��� $\displaystyle\sum_{d\mid T}d^k\mu(\frac{T}{d})$��</p>
<p>�Ȼ�Ϊ�������׾�������ʽ���� $f(n)&#x3D;(\operatorname{id_k}*\mu)(n)&#x3D;\displaystyle\sum_{d\mid n}d^k\mu(\frac{n}{d})$������ $f(n)$ ��Ϊ����</p>
<p>��Ϊ $\operatorname{id_k},\mu$�����Ը��ݵ������׾��������ʣ�$f$ Ҳ�ǻ��Ժ������ָ���Ψһ�ֽⶨ�������Եõ���</p>
<p>$$<br>\begin{aligned}<br>f(n)&#x3D;\displaystyle\prod_{i&#x3D;1}f(p_i^{s_i})<br>\end{aligned}<br>$$</p>
<p>���� $f(p_i^{k_i})$��</p>
<p>$$<br>\begin{aligned}<br>f(p_i^{s_i})&#x3D;\displaystyle\sum_{d\mid p_i^{s_i}}d^k\mu(\frac{p_i^{s_i}}{d})<br>\end{aligned}<br>$$</p>
<p>���� $\mu$ �����ʣ�</p>
<p>$$<br>\begin{aligned}<br>\mu(\frac{p_i^{s_i}}{d})&#x3D;<br>\begin{cases}<br>d&#x3D;p_i^{s_i}&amp;\implies\mu(1)&#x3D;1\<br>d&#x3D;p_i^{s_i-1}&amp;\implies\mu(p_i)&#x3D;-1\<br>d&#x3D;p_i^{[0,s_i-1)}&amp;\implies\mu(p_i^{x})&#x3D;0,(x\gt1)\<br>\end{cases}<br>\end{aligned}<br>$$</p>
<p>���Է��֣�</p>
<p>$$<br>\begin{aligned}<br>f(p_i^{s_i})<br>&amp;&#x3D;\displaystyle\sum_{d\mid p_i^{s_i}}d^k\mu(\frac{p_i^{s_i}}{d})\<br>&amp;&#x3D;{p_i^{s_i\times k}}\mu(1)+{p_i^{(s_i-1)\times k}}\mu(p_i)\<br>&amp;&#x3D;{p_i^{s_i\times k}}-{p_i^{(s_i-1)\times k}}\<br>&amp;&#x3D;{p_i^{(s_i-1)\times k}}\times(p_i^k-1)\\<br>\because f(p_i^{s_i-1})&amp;&#x3D;{p_i^{(s_i-2)\times k}}\times(p_i^k-1)\qquad s_i\gt1\<br>\therefore f(p_i^{s_i})&amp;&#x3D;<br>\begin{cases}<br>f(p_i^{s_i-1})\times p_i^k&amp;s_i\gt1\<br>p_i^k-1&amp;s_i&#x3D;1<br>\end{cases}<br>\end{aligned}<br>$$</p>
<p>������ŷ��ɸ�Ĺ����У���ǰ��֪ $f(i)$��Ҫ�� $f(i\times p)$��</p>
<p>$$<br>\begin{aligned}<br>f(i)&amp;&#x3D;i^k-1\qquad&amp;i\in prime\<br>f(i\times p)&amp;&#x3D;f(i)\times p^k\qquad&amp;[p\mid i]\<br>f(i\times p)&amp;&#x3D;f(i)\times f(p)\qquad&amp;[p\nmid i]\<br>\end{aligned}<br>$$</p>
<h4 id="Code-12"><a href="#Code-12" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, k, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            f[i] = <span class="built_in">pow</span>(i, k) - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                f[i * p[j]] = f[i] * <span class="built_in">pow</span>(p[j], k);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + f[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-9"><a href="#Question-9" class="headerlink" title="Question 9"></a>Question 9</h3><h4 id="��L-9"><a href="#��L-9" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(i)\tau(j)\tau(\gcd(i,j))<br>$$</p>
<h4 id="֤��-9"><a href="#֤��-9" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(i)\tau(j)\tau(\gcd(i,j))<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\tau(d)\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(i)\tau(j)[\gcd(i,j)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\tau(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\tau(id)\tau(jd)[\gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\tau(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\tau(id)\tau(jd)\displaystyle\sum_{s\mid \gcd(i,j)}\mu(s)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\tau(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{ds}\rfloor}\tau(ids)\tau(jds)\<br>\end{aligned}<br>$$</p>
<p>��Ԫ $T&#x3D;ds$��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{d&#x3D;1}^{n}\tau(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{ds}\rfloor}\tau(ids)\tau(jds)<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\tau(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\tau(iT)\tau(jT)\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{d\mid T}\mu(\frac{T}{d})\tau(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\tau(iT)\tau(jT)<br>\end{aligned}<br>$$</p>
<p>��Ϊ�� $\mu<em>\tau&#x3D;1$�����Եõ���$\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{d\mid T}\mu(\frac{T}{d})\tau(d)&#x3D;(\mu</em>\tau)(T)&#x3D;1(T)&#x3D;1$��</p>
<p>Ȼ��õ����ʽ�ӣ�$\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\tau(iT)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\tau(jT)$��</p>
<p>��Ϊ��������������� $n,m\leqslant 2\times 10^6$ ֱ������ɸ $\tau$ Ԥ����ǰ׺�;����ˣ�ʱ�临�Ӷ� $(n\ln n)$������ͨ����</p>
<p>���ݼ�ǿʱ�����õ������׾�����׺���Ż��������Ҳ���<del>����……��</del>��</p>
<h4 id="Code-13"><a href="#Code-13" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"><span class="type">int</span> g[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, k, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    g[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            g[i] = <span class="number">1</span>;</span><br><span class="line">            f[i] = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i * p[j]] = g[i] + <span class="number">1</span>;</span><br><span class="line">                f[i * p[j]] = f[i] / (g[i] + <span class="number">1</span>) * (g[i * p[j]] + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            g[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; i * j &lt;= n; j++)</span><br><span class="line">        sum[j] = (sum[j - <span class="number">1</span>] + f[i * j]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="built_in">max</span>(n, m));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">min</span>(n, m); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">initival</span>(i, <span class="built_in">max</span>(n, m));</span><br><span class="line">        ans += sum[n / i] * sum[m / i];</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>����ĵ������׾�����׺���Ż��ο����룬ʱ�临�Ӷ� $O(n\log\log n)$��</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memcpy</span>(sumn, f, <span class="built_in">sizeof</span>(sumn));</span><br><span class="line">    <span class="built_in">memcpy</span>(summ, f, <span class="built_in">sizeof</span>(summ));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k : p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = n / k; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            sumn[i] += sumn[i * k];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = m / k; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            summ[i] += summ[i * k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="built_in">max</span>(n, m));</span><br><span class="line">    <span class="built_in">initival</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">min</span>(n, m); i++)</span><br><span class="line">        ans += sumn[i] * summ[i];</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-10"><a href="#Question-10" class="headerlink" title="Question 10"></a>Question 10</h3><h4 id="��L-10"><a href="#��L-10" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid i\land d\mid j}d[\displaystyle\sum_{d\mid i\land d\mid j}d\leqslant a]<br>$$</p>
<h4 id="֤��-10"><a href="#֤��-10" class="headerlink" title="֤��"></a>֤��</h4><p>���ȣ�$[d\mid i\land d\mid j]\iff [d\mid \gcd(i,j)]$��</p>
<p>�裺$\sigma(n)$ Ϊ $n$ ��Լ�������͡�</p>
<p>�Ⱥ��� $[\displaystyle\sum_{d\mid i\land d\mid j}d\leqslant a]$ ������ơ�</p>
<p>�������֤���в�ͨ����Ϊ�޷��������ƣ�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid i\land d\mid j}d<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{n}[d\mid i]\displaystyle\sum_{j&#x3D;1}^{m}[d\mid j]d\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}d\lfloor\frac{n}{d}\rfloor\lfloor\frac{m}{d}\rfloor<br>\end{aligned}<br>$$</p>
<p>��һ��˼·��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\displaystyle\sum_{d\mid i\land d\mid j}d<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\sigma(\gcd(i,j))\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\sigma(d)\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;d]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\sigma(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\sigma(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\displaystyle\sum_{s\mid\gcd(i,j)}\mu(s)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\sigma(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{ds}\rfloor\lfloor\frac{m}{ds}\rfloor\<br>\end{aligned}<br>$$</p>
<p>������ $T&#x3D;ds$��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{d&#x3D;1}^{n}\sigma(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{ds}\rfloor\lfloor\frac{m}{ds}\rfloor<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\sigma(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{T}\rfloor\lfloor\frac{m}{T}\rfloor\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{n}\lfloor\frac{n}{T}\rfloor\lfloor\frac{m}{T}\rfloor\displaystyle\sum_{d\mid T}\sigma(d)\mu(\frac{T}{d})<br>\end{aligned}<br>$$</p>
<p>ʽ�ӻ���������ʵ����Ҫͳ������ $\sigma(n)\leqslant a$ �Ĺ��ף�$\sigma$ ��������ɸ����Ȼ����������⡣</p>
<ul>
<li><p>����ѯ�ʣ�$a$ ����ͬ��</p>
<p>  �������ѯ�ʣ����Կ����Ȱ�ѯ�������������� $a$ <strong>��С��������</strong>����������ֻ����������̬ά�� $\displaystyle\sum_{d\mid T}\sigma(d)\mu(\frac{T}{d})$ ǰ׺�͡�</p>
</li>
<li><p>��̬ά�� $\displaystyle\sum_{d\mid T}\sigma(d)\mu(\frac{T}{d})$ ǰ׺�ͣ�</p>
<p>  ��������״����ά����������ɸ�� $\sigma$��Ȼ�� $\sigma$ ������Ϊѯ��ʱ $a$ ��������������ÿ�δ���һ��ѯ��֮ǰ�Ƚ� $\sigma(d)\leqslant a$ �Ĺ���ͨ������ö�� $d$ �ı�������ǰ׺�ͣ�Ȼ�������۷ֿ鴦����</p>
</li>
</ul>
<h4 id="Code-14"><a href="#Code-14" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">bitset&lt;N&gt; vis;</span><br><span class="line"><span class="type">int</span> g[N];</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line">ll ans[N];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">type</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> x, y;</span><br><span class="line">    <span class="keyword">friend</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> type &amp;A, <span class="type">const</span> type &amp;B)&#123;<span class="keyword">return</span> A.x &gt; B.x;&#125;</span><br><span class="line">    <span class="built_in">type</span>(<span class="type">int</span> x = <span class="number">0</span>, <span class="type">int</span> y = <span class="number">0</span>) : <span class="built_in">x</span>(x), <span class="built_in">y</span>(y)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">vector&lt;type&gt; V;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">question</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n, m, i, a;</span><br><span class="line">    <span class="keyword">friend</span> <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> question &amp;A, <span class="type">const</span> question &amp;B)&#123;<span class="keyword">return</span> A.a &lt; B.a;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">question q[N];</span><br><span class="line"><span class="keyword">namespace</span> BIT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> lowbit(x) ((+x) &amp; (-x))</span></span><br><span class="line">    ll tr[N];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (x &lt;= <span class="number">1e5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            tr[x] += val;</span><br><span class="line">            x += <span class="built_in">lowbit</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x &gt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans += tr[x];</span><br><span class="line">            x -= <span class="built_in">lowbit</span>(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">update</span><span class="params">(<span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i * d &lt;= <span class="number">1e5</span>; i++)</span><br><span class="line">            <span class="built_in">add</span>(i * d, f[d] * mu[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> BIT;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    g[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            g[i] = i + <span class="number">1</span>;</span><br><span class="line">            f[i] = i + <span class="number">1</span>;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i * p[j]] = g[i] * p[j] + <span class="number">1</span>;</span><br><span class="line">                f[i * p[j]] = f[i] / g[i] * g[i * p[j]];</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            g[i * p[j]] = p[j] + <span class="number">1</span>;</span><br><span class="line">            f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        V.<span class="built_in">emplace_back</span>(<span class="built_in">type</span>(f[i], i));</span><br><span class="line">    <span class="built_in">sort</span>(V.<span class="built_in">begin</span>(), V.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!V.<span class="built_in">empty</span>() &amp;&amp; V.<span class="built_in">rbegin</span>()-&gt;x &lt;= a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">update</span>(V.<span class="built_in">rbegin</span>()-&gt;y);</span><br><span class="line">        V.<span class="built_in">pop_back</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= T; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; q[i].n &gt;&gt; q[i].m &gt;&gt; q[i].a;</span><br><span class="line">        q[i].i = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="number">1e5</span>);</span><br><span class="line">    <span class="built_in">sort</span>(q + <span class="number">1</span>, q + T + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= T; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> n = q[i].n;</span><br><span class="line">        <span class="type">int</span> m = q[i].m;</span><br><span class="line">        <span class="built_in">initival</span>(q[i].a);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">            ans[q[i].i] += (<span class="built_in">query</span>(r) - <span class="built_in">query</span>(l - <span class="number">1</span>)) * (n / l) * (m / l);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= T; i++)</span><br><span class="line">        cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-11"><a href="#Question-11" class="headerlink" title="Question 11"></a>Question 11</h3><h4 id="��L-11"><a href="#��L-11" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{m}F_{\gcd(i,j)}<br>$$</p>
<p>$F_n$ Ϊ $\operatorname{Fibonacci}$ ���е� $n$ �</p>
<h4 id="֤��-11"><a href="#֤��-11" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{m}F_{\gcd(i,j)}<br>&amp;&#x3D;\displaystyle\prod_{d&#x3D;1}^{n}F_d^{\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;d]}\<br>&amp;&#x3D;\displaystyle\prod_{d&#x3D;1}^{n}F_d^{\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]}\<br>\end{aligned}<br>$$</p>
<p>�� $g(n,m)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;1]$��Ī����˹������·ʽ��</p>
<p>$$<br>g(n,m)&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\lfloor\frac{n}{d}\rfloor\lfloor\frac{m}{d}\rfloor<br>$$</p>
<p>��Ԫ���룺</p>
<p>$$<br>\displaystyle\prod_{d&#x3D;1}^{n}F_d^{\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]}&#x3D;\displaystyle\prod_{d&#x3D;1}^{n}F_d^{g(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)}<br>$$</p>
<p>����ɸ $\mu$ ��ǰ׺��Ȼ��ֱ�ӱ��������ݾͿ����ˡ�</p>
<p>��ʵ���н�һ���Ż��ռ䣬���԰�ʱ�临�Ӷ��Ż��� $\sqrt n$������ʽ���Ƶ�����Ϳ���ͨ���ˡ�</p>
<h4 id="Code-15"><a href="#Code-15" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> IO</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP&gt; <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">(TP &amp;n)</span></span>&#123;TP w=<span class="number">1</span>;<span class="type">char</span> x=<span class="built_in">getchar</span>();n=<span class="number">0</span>;<span class="keyword">while</span>(x&lt;<span class="string">&#x27;0&#x27;</span>||x&gt;<span class="string">&#x27;9&#x27;</span>)&#123;<span class="keyword">if</span>(x==<span class="string">&#x27;-&#x27;</span>)w=<span class="number">-1</span>;x=<span class="built_in">getchar</span>();&#125;<span class="keyword">while</span>(x&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;x&lt;=<span class="string">&#x27;9&#x27;</span>)&#123;n=(n&lt;&lt;<span class="number">1</span>)+(n&lt;&lt;<span class="number">3</span>)+(x^<span class="number">48</span>);x=<span class="built_in">getchar</span>();&#125;<span class="keyword">return</span> n*=w,<span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP&gt; <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">write</span><span class="params">(TP x)</span></span>&#123;<span class="keyword">if</span>(!x)<span class="keyword">return</span> <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>),<span class="number">1</span>;<span class="type">short</span> s[<span class="number">20</span>],top=<span class="number">0</span>;<span class="keyword">if</span>(x&lt;<span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>),x=-x;<span class="keyword">while</span>(x)&#123;s[++top]=x%<span class="number">10</span>;x/=<span class="number">10</span>;&#125;<span class="keyword">while</span>(top&gt;<span class="number">0</span>) <span class="built_in">putchar</span>(s[top--]+<span class="string">&#x27;0&#x27;</span>);<span class="keyword">return</span> <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP&gt; <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">write</span><span class="params">(TP n,<span class="type">char</span> x)</span></span>&#123;<span class="built_in">write</span>(n),<span class="built_in">putchar</span>(x);<span class="keyword">return</span> <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt; <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">(TP &amp;n,Etc &amp;...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">read</span>(n)+<span class="built_in">read</span>(etcs...);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IO;</span><br><span class="line"><span class="keyword">namespace</span> calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> MOD=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> PHI=<span class="number">1e9</span>+<span class="number">6</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x+y&gt;=MOD?x+y-MOD:x+y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x-y+MOD:x-y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> (ll)x*y%MOD;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Add</span>(<span class="built_in">Add</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Red</span>(<span class="built_in">Red</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ksm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> ans=<span class="number">1</span>)</span></span>&#123;<span class="keyword">while</span>(y&gt;<span class="number">0</span>)&#123;<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans=<span class="built_in">Mul</span>(ans,x);x=<span class="built_in">Mul</span>(x,x);y&gt;&gt;=<span class="number">1</span>;&#125;<span class="keyword">return</span> ans;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Inv</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Ksm</span>(x,MOD<span class="number">-2</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> calc;</span><br><span class="line"><span class="type">int</span> T, n, m, cnt;</span><br><span class="line"><span class="type">int</span> F[N];</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> mul[N];</span><br><span class="line"><span class="type">int</span> inv[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">int</span> prime[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++cnt] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= cnt &amp;&amp; (ll)i * prime[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            mu[i * prime[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">g</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        ans += (ll)(sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (m / l);</span><br><span class="line">    &#125;</span><br><span class="line">    ans %= PHI;</span><br><span class="line">    <span class="keyword">return</span> !ans ? PHI : ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    F[<span class="number">1</span>] = F[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    mul[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">3</span>; i &lt;= n; i++)</span><br><span class="line">        F[i] = <span class="built_in">Add</span>(F[i - <span class="number">1</span>], F[i - <span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        mul[i] = <span class="built_in">Mul</span>(mul[i - <span class="number">1</span>], F[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        inv[i] = <span class="built_in">Inv</span>(mul[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="number">1e6</span>);</span><br><span class="line">    <span class="built_in">initival</span>(<span class="number">1e6</span>);</span><br><span class="line">    <span class="keyword">while</span> (T-- &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">read</span>(n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= <span class="built_in">min</span>(n, m); l = r + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">            ans = <span class="built_in">Mul</span>(ans, <span class="built_in">Ksm</span>(<span class="built_in">Mul</span>(mul[r], inv[l - <span class="number">1</span>]), <span class="built_in">g</span>(n / l, m / l)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">write</span>(ans, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-12"><a href="#Question-12" class="headerlink" title="Question 12"></a>Question 12</h3><h4 id="��L-12"><a href="#��L-12" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(ij)\varphi(ij)<br>$$</p>
<h4 id="֤��-12"><a href="#֤��-12" class="headerlink" title="֤��"></a>֤��</h4><p>�����˽⣺</p>
<p>$$<br>\begin{aligned}<br>\tau(n)&amp;&#x3D;\displaystyle\sum_{x\mid n}^{n}1\qquad\text{Լ�������Ķ���}\<br>\tau(ij)&amp;&#x3D;\displaystyle\sum_{x\mid i}^{i}\displaystyle\sum_{y\mid j}^{j}1\<br>\varphi(ij)&amp;&#x3D;\frac{\varphi(i)\varphi(j)\gcd(i,j)}{\varphi(\gcd(i,j))}<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(ij)\varphi(ij)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)\displaystyle\sum_{x\mid i}\displaystyle\sum_{y\mid j}[\gcd(x,y)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)\displaystyle\sum_{x\mid i}\displaystyle\sum_{y\mid j}\displaystyle\sum_{d\mid \gcd(x,y)}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)\displaystyle\sum_{x\mid i}\displaystyle\sum_{y\mid j}\displaystyle\sum_{d\mid x\land d\mid y}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)\displaystyle\sum_{d\mid i\land d\mid j}\displaystyle\sum_{d\mid x\land x\mid i}\displaystyle\sum_{d\mid y\land y\mid j}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)\displaystyle\sum_{d\mid \gcd(i,j)}\displaystyle\sum_{xd\mid i}\displaystyle\sum_{yd\mid j}\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)\displaystyle\sum_{d\mid \gcd(i,j)}\tau(\frac{i}{d})\tau(\frac{j}{d})\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{n}[d\mid i]\displaystyle\sum_{j&#x3D;1}^{m}[d\mid j]\varphi(ij)\tau(\frac{i}{d})\tau(\frac{j}{d})\mu(d)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\varphi(ijd^2)\tau(\frac{id}{d})\tau(\frac{jd}{d})\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}\frac{\varphi(id)\varphi(jd)\gcd(id,jd)}{\varphi(\gcd(id,jd))}\tau(i)\tau(j)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;s]\frac{\varphi(id)\varphi(jd)ds}{\varphi(ds)}\tau(i)\tau(j)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{ds}\rfloor}[\gcd(i,j)&#x3D;1]\frac{\varphi(ids)\varphi(jds)ds}{\varphi(ds)}\tau(is)\tau(js)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{ds}\rfloor}\displaystyle\sum_{t\mid\gcd(i,j)}\mu(t)\frac{\varphi(ids)\varphi(jds)ds}{\varphi(ds)}\tau(is)\tau(js)\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{t&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\mu(t)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{dst}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{dst}\rfloor}\frac{\varphi(idst)\varphi(jdst)ds}{\varphi(ds)}\tau(ist)\tau(jst)\<br>\end{aligned}<br>$$</p>
<p>�����õ����ۣ�</p>
<p>$$<br>\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\frac{ds}{\varphi(ds)}\displaystyle\sum_{t&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\mu(t)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{dst}\rfloor}\tau(ist)\varphi(dist)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{dst}\rfloor}\tau(jst)\varphi(djst)<br>$$</p>
<p>���ֺ�����һ���� $\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{dst}\rfloor}\tau(ist)\varphi(dist)$ �� $\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{dst}\rfloor}\tau(jst)\varphi(djst)$ ����Ԥ������ʱ�临�Ӷ� $O(n\log^2n)$���� $g(n,d,x)&#x3D;\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{dx}\rfloor}\tau(ix)\varphi(dix)$��Ԥ�������ǰ����һ���� $\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\frac{ds}{\varphi(ds)}\displaystyle\sum_{t&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\mu(t)g(n,d,st)g(m,d,st)$ Ҳ�� $O(n\log^2n)$������ʱ�临�Ӷ� $O(n\log^2n)$��</p>
<p>����Ҫɸ $\mu,\varphi,\tau\qquad\text{QWQ}$��</p>
<h4 id="Code-16"><a href="#Code-16" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> MOD=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x+y&gt;=MOD?x+y-MOD:x+y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x-y+MOD:x-y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> (ll)x*y%MOD;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Add</span>(<span class="built_in">Add</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Red</span>(<span class="built_in">Red</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ksm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> ans=<span class="number">1</span>)</span></span>&#123;<span class="keyword">while</span>(y&gt;<span class="number">0</span>)&#123;<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans=<span class="built_in">Mul</span>(ans,x);x=<span class="built_in">Mul</span>(x,x);y&gt;&gt;=<span class="number">1</span>;&#125;<span class="keyword">return</span> ans;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Inv</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Ksm</span>(x,MOD<span class="number">-2</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> calc;</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"><span class="type">int</span> g[N];</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> phi[N];</span><br><span class="line"><span class="type">int</span> inv[N];</span><br><span class="line"><span class="type">int</span> sumn[N];</span><br><span class="line"><span class="type">int</span> summ[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    g[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            g[i] = <span class="number">1</span>;</span><br><span class="line">            f[i] = <span class="number">2</span>;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i * p[j]] = g[i] + <span class="number">1</span>;</span><br><span class="line">                f[i * p[j]] = f[i] / (g[i] + <span class="number">1</span>) * (g[i * p[j]] + <span class="number">1</span>);</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            g[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">            phi[i * p[j]] = phi[i] * phi[p[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        inv[i] = <span class="built_in">Inv</span>(phi[i]);</span><br><span class="line">        mu[i] = <span class="built_in">Add</span>(MOD, mu[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m, <span class="type">int</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i * d &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sumn[i] = summ[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; i * j * d &lt;= n; j++)</span><br><span class="line">            sumn[i] = <span class="built_in">Add</span>(sumn[i], <span class="built_in">Mul</span>(f[i * j], phi[i * j * d]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; i * j * d &lt;= m; j++)</span><br><span class="line">            summ[i] = <span class="built_in">Add</span>(summ[i], <span class="built_in">Mul</span>(f[i * j], phi[i * j * d]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="built_in">max</span>(n, m));</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m)</span><br><span class="line">        <span class="built_in">swap</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> d = <span class="number">1</span>; d &lt;= n; d++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">initival</span>(n, m, d); <span class="comment">// Ԥ����</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> s = <span class="number">1</span>; s * d &lt;= n; s++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> t = <span class="number">1</span>; t * d * s &lt;= n; t++)</span><br><span class="line">                ans = <span class="built_in">Add</span>(ans, <span class="built_in">Mul</span>(mu[d], mu[t], d, s, inv[d * s], sumn[s * t], summ[s * t]));</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">Add</span>(ans, MOD);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-13"><a href="#Question-13" class="headerlink" title="Question 13"></a>Question 13</h3><h4 id="��L-13"><a href="#��L-13" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}\gcd(i,j)\alpha(\gcd(i,j))(i+j)^k<br>$$</p>
<p>$$<br>\alpha(n)&#x3D;<br>\begin{cases}<br>1&amp;\text{nû��ƽ������}\<br>0&amp;\text{othses}\<br>\end{cases}<br>$$</p>
<h4 id="֤��-13"><a href="#֤��-13" class="headerlink" title="֤��"></a>֤��</h4><p>���ȷ��� $\alpha(n)&#x3D;\operatorname{abs}(\mu(n))&#x3D;\mu^2(n)$��</p>
<p>Ȼ���ǻ���ʽ�ӣ�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}\gcd(i,j)\alpha(\gcd(i,j))(i+j)^k<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\alpha(d)d\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}<a href="i+j">\gcd(i,j)&#x3D;d</a>^k\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\alpha(d)d\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}<a href="i+j">\gcd(i,j)&#x3D;1</a>^k\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\alpha(d)d\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{s\mid (\gcd(i,j)}\mu(s)(id+jd)^k\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\alpha(d)d\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}(ids+jds)^k\<br>\end{aligned}<br>$$</p>
<p>��·��Ԫ��$T&#x3D;ds$��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{d&#x3D;1}^{n}\alpha(d)d\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}(ids+jds)^k<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\alpha(d)d\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}(iT+jT)^k\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d\mid T}^{n}\alpha(d)\mu(\frac{T}{d})dT^k\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}(i+j)^k<br>\end{aligned}<br>$$</p>
<p>ƿ�����������ȴ����� $1$ ����</p>
<ol>
<li><p>$\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}(i+j)^k$</p>
<p> �� $S(n)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}(i+j)^k$��������� $O(n)$ ���ơ�</p>
<p> ����չ����</p>
<p> $$<br> \begin{aligned}<br> S(n)<br> &amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}(i+j)^k\<br> &amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n-1}\displaystyle\sum_{j&#x3D;1}^{n-1}(i+j)^k+\displaystyle\sum_{i&#x3D;1}^{n}(n+i)^k+\displaystyle\sum_{i&#x3D;1}^{n-1}(i+n)^k\<br> &amp;&#x3D;S(n-1)+\displaystyle\sum_{i&#x3D;n+1}^{2n-1}i^k+\displaystyle\sum_{i&#x3D;n+1}^{2n-1}i^k+(2n)^k\<br> &amp;&#x3D;S(n-1)+2(\displaystyle\sum_{i&#x3D;1}^{2n-1}\operatorname{id_k(i)}-\displaystyle\sum_{i&#x3D;1}^{n}\operatorname{id_k(i)})+\operatorname{id_k(2n)}<br> \end{aligned}<br> $$</p>
<p> ����ɸ $\operatorname{id_k}$ ��ǰ׺�;����ˣ����� $O(n)$ ���Ƴ������� $S$��</p>
</li>
<li><p>$\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d\mid T}^{n}\alpha(d)\mu(\frac{T}{d})dT^kS(\lfloor\frac{n}{T}\rfloor)$</p>
<p> $T^kS(\lfloor\frac{n}{T}\rfloor)$ ֱ�� $O(1)$������ $\operatorname{id_kT\times S(\lfloor\frac{n}{T}\rfloor)}$������ǰ����һ���֡�</p>
<p> $\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d\mid T}^{n}\alpha(d)\mu(\frac{T}{d})d$��ֱ��ö�� $d$ �ı���Ԥ������ʱ�临�Ӷ� $O(n\ln n),n\leqslant5\times 10^5$��ֱ�Ӽ�����</p>
<p> ����ʹ����������׺�׺���Ż���ʱ�临�Ӷ� $O(n\log\log n)$��</p>
<p> ��������׺�׺�ͣ������ڴ�������֪���Ժ��� $f$ �������� $n$����Ҫ��ȡ���Ժ��� $g$��</p>
<p> $$<br> g(n)&#x3D;\displaystyle\sum_{d\mid n}f(d)<br> $$</p>
<p> ���ڱ��⣬�� $f(n)&#x3D;\mu^2(n)d,g(n)&#x3D;\displaystyle\sum_{d\mid n}\mu^2(d)\mu(\frac{n}{d})d&#x3D;\displaystyle\sum_{d\mid n}f(n)*\mu(\frac{n}{d})$</p>
<p> ����ͬʱ�� $1$���õ�:</p>
<p> $$<br> \begin{aligned}<br> (g<em>1)(n)<br> &amp;&#x3D;(f</em>(u<em>1))(n)\<br> &amp;&#x3D;\displaystyle\sum_{d\mid n}g(d)&#x3D;(f</em>\varepsilon)(n)\<br> &amp;&#x3D;\displaystyle\sum_{d\mid n}g(d)&#x3D;f(n)\<br> \end{aligned}<br> $$</p>
<p> Ȼ��Ϳ�����������׺�׺���Ż���ȡ����� $g(n)\times \operatorname{id_k}(n)$ ����ǰ����һ���֣�Ȼ���� $g(n)\times \operatorname{id_k}(n)$ ��ǰ׺�ͺ����۷ֿ飬�ɹ��ˡ�</p>
<p> ��Ȼ������񻹿���ֱ������ɸ��ʱ�临�Ӷ� $O(n)$��</p>
</li>
</ol>
<h4 id="Code-17"><a href="#Code-17" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">int</span> S[N];</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> sum[N];</span><br><span class="line"><span class="type">int</span> idk[N];</span><br><span class="line"><span class="type">int</span> sumidk[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="type">int</span> n, m, ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    idk[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            idk[i] = <span class="built_in">pow</span>(i, m);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            idk[i * p[j]] = idk[i] * idk[p[j]];</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sumidk[i] = sumidk[i - <span class="number">1</span>] + idk[i];</span><br><span class="line">    n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        S[i] = S[i - <span class="number">1</span>] + idk[<span class="number">2</span> * i] + <span class="number">2</span> * (sumidk[<span class="number">2</span> * i - <span class="number">1</span>] - sumidk[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = i * mu[i] * mu[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = p.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = n / p[i]; j &gt;= <span class="number">1</span>; j--)</span><br><span class="line">            sum[p[i] * j] -= sum[j];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] *= idk[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">Euler</span>(n &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">initival</span>(n &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans += (sum[r] - sum[l - <span class="number">1</span>]) * S[n / l];</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-14"><a href="#Question-14" class="headerlink" title="Question 14"></a>Question 14</h3><h4 id="��L-14"><a href="#��L-14" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{m}\varphi(ij)<br>$$</p>
<p><strong>����</strong>ѯ�� $1\leqslant T\leqslant 10^4,1\leqslant n\leqslant 10^5$��</p>
<h4 id="j��-2"><a href="#j��-2" class="headerlink" title="ǰ��"></a>ǰ��</h4><p>ͻȻ����������֮ǰ��һ���⣺</p>
<p>$$<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\tau(ij)\varphi(ij)<br>$$</p>
<p><strong>����</strong>ѯ�� $1\leqslant n\leqslant 5\times 10^5$��</p>
<p><del>���²����������</del>��</p>
<p>�ǵ����ʽ����ô������ĥ��һ���磩��</p>
<p>$$<br>\displaystyle\sum_{d&#x3D;1}^{n}\mu(d)\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\frac{ds}{\varphi(ds)}\displaystyle\sum_{t&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\mu(t)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{dst}\rfloor}\tau(ist)\varphi(dist)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{dst}\rfloor}\tau(jst)\varphi(djst)<br>$$</p>
<p>Ȼ��������ʽ����ô�̣������˲��� $10$ ���Ӿ��Ƴ����ˣ���Ī�Ǿ��Ǻ��⣿����</p>
<p>$$<br>\displaystyle\sum_{d&#x3D;1}^{n}\frac{d}{\varphi(d)}\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\varphi(ids)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{ds}\rfloor}\varphi(jds)<br>$$</p>
<p>$$<br>\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\varphi(iT)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\varphi(jT)<br>$$</p>
<p>��������������ʽ�Ӷ�û�취��������ѯ�ʣ����һ������ˡ�</p>
<h4 id="����h����"><a href="#����h����" class="headerlink" title="����ĥ����"></a>����ĥ����</h4><h5 id="part-1"><a href="#part-1" class="headerlink" title="part 1"></a>part 1</h5><p>���ȵ�һ��ʽ�ӣ�����֮ǰ�ǵ�����ķ���������ʱ�临�Ӷȣ�$O(n\log^2n)$������ʱ�临�Ӷ� $O(n\ln n+Tn\log^2n)$�����ڶ���ѯ�ʣ���ʱ�Ķ������ˣ�ϲ�� $40$ �֣�$14.96s$��</p>
<h5 id="part-2"><a href="#part-2" class="headerlink" title="part 2"></a>part 2</h5><p>�ڶ���ʽ�ӣ����䱶��ö�� $O(n\ln n)$ Ԥ���� $\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})$�������ǲ������ߴ�����ʱ�临�Ӷ� $O(n\log n)$������ʱ�临�Ӷ� $O(n\ln n+Tn\log n)$���ٸ� $\log n$ ����ûɶ�ã����� $40$ �֣�$13.79s$��</p>
<h5 id="part-3"><a href="#part-3" class="headerlink" title="part 3"></a>part 3</h5><p>��������������׾����ˣ����Ƿ��� $\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})$ �Ҿ�������Ҫ��û���Ǹ� $\frac{1}{\varphi(d)}$������ $\operatorname{id}*\mu&#x3D;\varphi$��Ӧ�û�ø�㡣����ʧ���ˡ�</p>
<h5 id="part-4"><a href="#part-4" class="headerlink" title="part 4"></a>part 4</h5><p>������ $O(n\ln n)$ Ԥ���� $\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})$�������ֶ������е� $T\in[1,1e5]$ Ԥ�������е� $\displaystyle\sum_{i&#x3D;1}^{n}\varphi(iT)$��ʱ�临�Ӷ� $O(n\ln n)$���ռ临�Ӷ��� <code>vector</code> ��̬�� $\frac{n}{T}$��Ҳ�� $O(n\ln n)$��Ȼ����� $O(n)$ ��ѯ������ʱ�临�Ӷ� $O(n\ln n+Tn)$��������ͻ�ƣ�$50$ �֣�������һ�� $\log$��</p>
<h5 id="part-5"><a href="#part-5" class="headerlink" title="part 5"></a>part 5</h5><p>�е�����������ȥ�ˡ�</p>
<blockquote>
<p>���ŷ���</p>
</blockquote>
<p>��������</p>
<blockquote>
<p>�������˵ݵ�Ƭ</p>
</blockquote>
<p>�������</p>
<blockquote>
<p>������ε��� <strong>�鳤</strong> ���� Ynoi</p>
</blockquote>
<p>���ͷ�������ô�����ŷ��ε�������ʱ�临�Ӷȣ�����̫���ˣ��ͽ�������ͼ��</p>
<p><img src="https://cdn.luogu.com.cn/upload/image_hosting/56yphxxt.png"></p>
<p>����� $S&#x3D;46$ ʱʱ�临�Ӷ����š�</p>
<p>���������Ԥ����һ���� $\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\varphi(iT)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\varphi(jT)$����ô������</p>
<p>�� $f(n)&#x3D;\displaystyle\sum_{d\mid n}\frac{d}{\varphi(d)}\mu(\frac{n}{d}),g(n,T)&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\varphi(iT)$��$f,n$ ����ԭ���ķ���ö�ٱ���ֱ�� $O(n\ln n)$ Ԥ������Ȼ���� $h$ ����������ʽ�ӣ��õ���</p>
<p>$$<br>\begin{aligned}<br>g(n,T)&amp;&#x3D;g(n-1,T)+\varphi(nT)\<br>h(k,n,m)&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{k}\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})\displaystyle\sum_{i&#x3D;1}^{n}\varphi(iT)\displaystyle\sum_{j&#x3D;1}^{m}\varphi(jT)&#x3D;\displaystyle\sum_{T&#x3D;1}^{k}f(T)g(n,T)g(m,T)<br>\end{aligned}<br>$$</p>
<p>�õ� $h$ �ĵ���ʽ��</p>
<p>$$<br>h(k,n,m)&#x3D;h(k-1,n,m)+f(k)g(n,k)g(m,k)<br>$$</p>
<p>Ȼ��ֻ���� $n,m\leqslant S$ ����һ���֣����౩������Ϊֱ��Ԥ���� $h$��ʱ��ռ䶼�޷����ܡ�</p>
<p>���ڴ�Ĳ���ֱ�����۷ֿ飬��������⡣�����ˡ�</p>
<p>���˵������������ͦ����ġ�</p>
<p>�������ǻ�����ҪһЩ�ȽϹٷ������Եģ�������Щ����Щ�ҡ�</p>
<h4 id="֤��-14"><a href="#֤��-14" class="headerlink" title="֤��"></a>֤��</h4><p>������·��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\varphi(ij)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}\frac{\varphi(i)\varphi(j)\gcd(i,j)}{\varphi(\gcd(i,j))}\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{m}[\gcd(i,j)&#x3D;d]\frac{\varphi(i)\varphi(j)d}{\varphi(d)}\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[\gcd(i,j)&#x3D;1]\frac{\varphi(id)\varphi(jd)d}{\varphi(d)}\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}[s\mid i]\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{d}\rfloor}[s\mid j]\frac{\varphi(id)\varphi(jd)d}{\varphi(d)}\<br>&amp;&#x3D;\displaystyle\sum_{d&#x3D;1}^{n}\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{ds}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{ds}\rfloor}\frac{\varphi(ids)\varphi(jds)d}{\varphi(d)}\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{n}\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\varphi(iT)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\varphi(jT)\<br>\end{aligned}<br>$$</p>
<p>�裺</p>
<p>$$<br>\begin{aligned}<br>f(x)&amp;&#x3D;\displaystyle\sum_{d\mid x}\frac{d}{\varphi(d)}\mu(\frac{x}{d})\<br>g(x,k)&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{x}\varphi(ik)\<br>\end{aligned}<br>$$</p>
<p>���ѷ��� $f$ ֱ��ö�ٱ�����ʱ�临�Ӷ� $O(n\ln n)$��</p>
<p>���� $g$ �����𿪣�Ҳ���Եõ����ĵ���ʽ��</p>
<p>$$<br>\begin{aligned}<br>g(x,k)<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{x}\varphi(ik)\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{x-1}\varphi(ik)+\varphi(xk)\<br>&amp;&#x3D;g(x-1,k)+\varphi(xk)\<br>\end{aligned}<br>$$</p>
<p>$g(x,k)$ �� $k$ ���Ͻ������Ŀ�����ķ�Χ $\operatorname{max}(n,m)$�� $x\in[1,\operatorname{max}(n,m)],k\in[1,\lfloor\frac{\operatorname{max}(n,m)}{x}\rfloor]$�����ʱ�临�Ӷ���ռ临�ӶȾ�Ϊ $O(n\ln n)$��</p>
<p>��ʱ���ڶ����ѯ��$O(n)$ ����������Ҫ�󣬿��ǽ�һ���Ż���</p>
<p>�� $h(x,a,b)$ Ϊ $\displaystyle\sum_{T&#x3D;1}^{x}\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})\displaystyle\sum_{i&#x3D;1}^{a}\varphi(iT)\displaystyle\sum_{j&#x3D;1}^{b}\varphi(jT)$��</p>
<p>��Ԫ�õ���</p>
<p>$$<br>h(x,a,b)&#x3D;\displaystyle\sum_{T&#x3D;1}^{x}f(T)g(a,T)g(b,T)<br>$$</p>
<p>������ʽ�ӵõ�����ʽ��</p>
<p>$$<br>\begin{aligned}<br>h(x,a,b)<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{x}f(T)g(a,T)g(b,T)\<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{x-1}f(T)g(a,T)g(b,T)+f(x)g(a,x)g(b,x)\<br>&amp;&#x3D;h(x-1,a,b)+f(x)g(a,x)g(b,x)<br>\end{aligned}<br>$$</p>
<p>�ã�����ʽ��ȫ��Ԥ����������ʱ��Ϳռ临�Ӷ� $O(n^2\ln n)$�����Ǹ�����˾������۷ֿ��ˡ����Ǹ��ŷ��Σ�</p>
<p>��Ϊ���� $T$ Խ���������Ӧ�� $\lfloor\frac{n}{T}\rfloor,\lfloor\frac{m}{T}\rfloor$ ԽС���������ǿ��Զ���С��һ����ֱ���� $f,g$ �����󣬼�������߽�Ϊ $S$��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{T&#x3D;1}^{\lfloor\frac{m}{S}\rfloor}\displaystyle\sum_{d\mid T}\frac{d}{\varphi(d)}\mu(\frac{T}{d})\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{T}\rfloor}\varphi(iT)\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{m}{T}\rfloor}\varphi(jT)<br>&amp;&#x3D;\displaystyle\sum_{T&#x3D;1}^{\lfloor\frac{m}{S}\rfloor}f(T)g(\lfloor\frac{n}{T}\rfloor,T)g(\lfloor\frac{m}{T}\rfloor,T)<br>\end{aligned}<br>$$</p>
<p>��һ�������۷ֿ飺</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{l&#x3D;\lfloor\frac{m}{S}\rfloor+1}^{n}h(r,\lfloor\frac{n}{T}\rfloor,\lfloor\frac{m}{T}\rfloor)-h(l-1,\lfloor\frac{n}{T}\rfloor,\lfloor\frac{m}{T}\rfloor){\text{change l,r by youself}}<br>\end{aligned}<br>$$</p>
<p>ʱ�临�ӶȾ������������⣬�ұ�ʾ������֤����</p>
<p>$$<br>n\ln n+nS\ln S+T(\sqrt n+\frac{n}{S})<br>$$</p>
<h4 id="Code-18"><a href="#Code-18" class="headerlink" title="Code"></a>Code</h4><p>���ǵ�һ�ΰѶ�����������أ���Ϊû�ж�����ԣ������ˮ�⡣</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> S = <span class="number">46</span>;</span><br><span class="line"><span class="keyword">namespace</span> calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> MOD=<span class="number">998244353</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x+y&gt;=MOD?x+y-MOD:x+y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x-y+MOD:x-y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;<span class="keyword">return</span> (ll)x*y%MOD;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Add</span>(<span class="built_in">Add</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Red</span>(<span class="built_in">Red</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Ksm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> ans=<span class="number">1</span>)</span></span>&#123;<span class="keyword">while</span>(y&gt;<span class="number">0</span>)&#123;<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans=<span class="built_in">Mul</span>(ans,x);x=<span class="built_in">Mul</span>(x,x);y&gt;&gt;=<span class="number">1</span>;&#125;<span class="keyword">return</span> ans;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Inv</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Ksm</span>(x,MOD<span class="number">-2</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> calc;</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; g[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; h[S + <span class="number">5</span>][S + <span class="number">5</span>];</span><br><span class="line"><span class="type">int</span> mu[N];</span><br><span class="line"><span class="type">int</span> phi[N];</span><br><span class="line"><span class="type">bool</span> vis[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">            phi[i * p[j]] = phi[i] * (p[j] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        mu[i] = <span class="built_in">Add</span>(mu[i], MOD);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> d = <span class="number">1</span>; d &lt;= n; d++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; d * k &lt;= n; k++)</span><br><span class="line">            f[d * k] = <span class="built_in">Add</span>(f[d * k], <span class="built_in">Mul</span>(d, <span class="built_in">Inv</span>(phi[d]), mu[k]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        g[k].<span class="built_in">resize</span>(n / k + <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x * k &lt;= n; x++)</span><br><span class="line">            g[k][x] = <span class="built_in">Add</span>(g[k][x - <span class="number">1</span>], phi[x * k]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> a = <span class="number">1</span>; a &lt;= S; a++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">1</span>; b &lt;= S; b++)</span><br><span class="line">        &#123;</span><br><span class="line">            h[a][b].<span class="built_in">resize</span>(n / b + <span class="number">5</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> x = <span class="number">1</span>; x * b &lt;= n; x++)</span><br><span class="line">                h[a][b][x] = <span class="built_in">Add</span>(h[a][b][x - <span class="number">1</span>], <span class="built_in">Mul</span>(f[x], g[x][a], g[x][b]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">Euler</span>(<span class="number">1e5</span>);</span><br><span class="line">    <span class="built_in">initival</span>(<span class="number">1e5</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T-- &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> n, m, ans = <span class="number">0</span>;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; m)</span><br><span class="line">            <span class="built_in">swap</span>(n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> T = <span class="number">1</span>; S * T &lt;= m; T++)</span><br><span class="line">            ans = <span class="built_in">Add</span>(ans, <span class="built_in">Mul</span>(f[T], g[T][n / T], g[T][m / T]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> l = m / S + <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">            ans = <span class="built_in">Add</span>(ans, <span class="built_in">Red</span>(h[n / l][m / l][r], h[n / l][m / l][l - <span class="number">1</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Question-15"><a href="#Question-15" class="headerlink" title="Question 15"></a>Question 15</h3><h4 id="��L-15"><a href="#��L-15" class="headerlink" title="��Ŀ"></a>��Ŀ</h4><p>$$<br>\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{\operatorname{lcm}(i,j)}{\gcd(i,j)}<br>$$</p>
<p>ʱ�����ƣ�$200\operatorname{ms}$</p>
<p>�ռ����ƣ�$7\operatorname{MB}$</p>
<p>ģ����$104857601$</p>
<h4 id="j��-3"><a href="#j��-3" class="headerlink" title="ǰ��"></a>ǰ��</h4><p>��Ҳ�ǱȽ�����˼����Ŀ�����ϵ���һ�����е�ǰ�ԡ���Ҫ�����Ǹ�ʱ�����ơ�</p>
<p>�Ȼ�����ʽ�ӣ�ܳ�˸�������$30$ �֡�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{\operatorname{lcm}(i,j)}{\gcd(i,j)}<br>&amp;&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{i\times j}{\gcd(i,j)^2}\<br>&amp;&#x3D;\displaystyle\prod_{d&#x3D;1}^{n}\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}(\frac{i\times j}{d^2})^{[\gcd(i,j)&#x3D;d]}\<br>&amp;&#x3D;\displaystyle\prod_{d&#x3D;1}^{n}\displaystyle\prod_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\prod_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}({i\times j})^{[\gcd(i,j)&#x3D;1]}<br>\end{aligned}<br>$$</p>
<p>ʱ�临�Ӷ� $O(n\log^3n)$��</p>
<p>Ȼ��˼·������ö�� $\gcd$��</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{\operatorname{lcm}(i,j)}{\gcd(i,j)}<br>&amp;&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{i\times j}{\gcd(i,j)^2}\<br>&amp;&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}ij\displaystyle\prod_{d&#x3D;1}^{n}\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}d^{-2[\gcd(i,j)&#x3D;d]}\<br>\end{aligned}<br>$$</p>
<p>�������ʽ�ӣ�ֱ�Ӷ���ָ��Ī����</p>
<p>Ȼ��ͣ�</p>
<p><img src="http://marchkidjoe.mygamesonline.org/wp-content/uploads/2022/10/MLE.png"></p>
<p>ûʲô������ȫ���˶��ѡ����Ѷ��Ѷ��ѡ���������</p>
<p>�治Ҫ����ֻ��Ҫ��</p>
<ul>
<li><p>��ɸ $\mu$ ������ $\text{int}\to\text{short}$��</p>
</li>
<li><p>$\text{bool}\to\text{bitset}$</p>
</li>
<li><p>ǰ׺�� $sum$ ������ $\text{int}\to\text{short}$����Ϊ�Ҵ������ $1e6$ ���ڵ� $\mu$ ��ǰ׺����� $311$��</p>
</li>
</ul>
<p>Ȼ��� <code>Accepted</code> �ˣ�ʱ�䲻��̫���ڹ�����ʱ�临�ӶȲ���������������� $O(n)$ ö�٣�ö�ٹ����������˸����۷ֿ顣</p>
<p>�����ռ�Ϳ��Թ������ˡ���Ȼ���Ͻ�֤���ٲ���</p>
<h4 id="֤��-15"><a href="#֤��-15" class="headerlink" title="֤��"></a>֤��</h4><p>$$<br>\begin{aligned}<br>\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{\operatorname{lcm}(i,j)}{\gcd(i,j)}<br>&amp;&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}\frac{i\times j}{\gcd(i,j)^2}\<br>&amp;&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}ij\displaystyle\prod_{d&#x3D;1}^{n}\displaystyle\prod_{i&#x3D;1}^{n}\displaystyle\prod_{j&#x3D;1}^{n}d^{-2[\gcd(i,j)&#x3D;d]}\<br>&amp;&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}i\displaystyle\prod_{j&#x3D;1}^{n}j\displaystyle\prod_{d&#x3D;1}^{n}d^{-2\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}[\gcd(i,j)&#x3D;d]}\<br>\end{aligned}<br>$$</p>
<p>ָ��������·���ݣ�</p>
<p>$$<br>\begin{aligned}<br>\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}[\gcd(i,j)&#x3D;d]<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}[\gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\displaystyle\sum_{i&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{j&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\displaystyle\sum_{s\mid \gcd(i,j)}\mu(s)\<br>&amp;&#x3D;\displaystyle\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{ds}\rfloor\lfloor\frac{n}{ds}\rfloor<br>\end{aligned}<br>$$</p>
<p>���۷ֿ鼴�ɣ�Ȼ��Ϳ��������$\displaystyle\prod_{d&#x3D;1}^{n}d^{-2\displaystyle\sum_{i&#x3D;1}^{n}\displaystyle\sum_{j&#x3D;1}^{n}[\gcd(i,j)&#x3D;d]}$��</p>
<p>�����ǰ�벿�֣�</p>
<p>$\displaystyle\prod_{i&#x3D;1}^{n}i\displaystyle\prod_{j&#x3D;1}^{n}j&#x3D;\displaystyle\prod_{i&#x3D;1}^{n}i\times n!&#x3D;(n!)^{2n}$</p>
<p>��ʽ�ӣ�</p>
<p>$$<br>\frac{(n!)^{2n}}{(\prod_{d&#x3D;1}^{n}d^{\sum_{s&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\mu(s)\lfloor\frac{n}{ds}\rfloor\lfloor\frac{n}{ds}\rfloor})^2}<br>$$</p>
<p>û�ˣ�໣����ˣ�$(a\times inv(b))\bmod p &#x3D;(a\bmod p)\times (inv(b)\bmod p)$��</p>
<h4 id="Code-19"><a href="#Code-19" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">namespace</span> calc</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> MOD=<span class="number">104857601</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Add</span><span class="params">(ll x,ll y)</span></span>&#123;<span class="keyword">return</span> x+y&gt;=MOD?x+y-MOD:x+y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Red</span><span class="params">(ll x,ll y)</span></span>&#123;<span class="keyword">return</span> x&lt;y?x-y+MOD:x-y;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Mul</span><span class="params">(ll x,ll y)</span></span>&#123;<span class="keyword">return</span> x*y%MOD;&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Add</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Add</span>(<span class="built_in">Add</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Red</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Red</span>(<span class="built_in">Red</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TP,<span class="keyword">typename</span>...Etc&gt;<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">Mul</span><span class="params">(TP n,TP m,Etc ...etcs)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Mul</span>(<span class="built_in">Mul</span>(n,m),etcs...);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Ksm</span><span class="params">(ll x,ll y,ll ans=<span class="number">1</span>)</span></span>&#123;<span class="keyword">while</span>(y&gt;<span class="number">0</span>)&#123;<span class="keyword">if</span>(y&amp;<span class="number">1</span>) ans=<span class="built_in">Mul</span>(ans,x);x=<span class="built_in">Mul</span>(x,x);y&gt;&gt;=<span class="number">1</span>;&#125;<span class="keyword">return</span> ans;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Inv</span><span class="params">(ll x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">Ksm</span>(x,MOD<span class="number">-2</span>);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> ll <span class="title">Fac</span><span class="params">(ll x)</span></span>&#123;ll ans=<span class="number">1</span>;<span class="keyword">while</span>(x)ans=<span class="built_in">Mul</span>(ans,x--);<span class="keyword">return</span> ans;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> calc;</span><br><span class="line"><span class="type">short</span> mu[N];</span><br><span class="line"><span class="type">short</span> sum[N];</span><br><span class="line">bitset&lt;N&gt; vis;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p.<span class="built_in">emplace_back</span>(i);</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>() &amp;&amp; i * p[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initival</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + mu[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ans += (ll)(sum[r] - sum[l - <span class="number">1</span>]) * (n / l) * (n / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>, n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">Euler</span>(n);</span><br><span class="line">    <span class="built_in">initival</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> d = <span class="number">1</span>; d &lt;= n; d++)</span><br><span class="line">        ans = <span class="built_in">Mul</span>(ans, <span class="built_in">Ksm</span>(d, <span class="built_in">f</span>(n / d)));</span><br><span class="line">    cout &lt;&lt; <span class="built_in">Mul</span>(<span class="built_in">Ksm</span>(<span class="built_in">Fac</span>(n), n &lt;&lt; <span class="number">1</span>), <span class="built_in">Ksm</span>(<span class="built_in">Inv</span>(ans), <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="����-8"><a href="#����-8" class="headerlink" title="����"></a>����</h2><p>Problem 0:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2158">P2158 [SDOI2008] ���̶�</a></p>
<p>Problem 1:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3455">P3455 [POI2007]ZAP-Queries</a></p>
<p>Problem 2:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2257">P2257 YY��GCD</a></p>
<p>Problem 3:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2522">P2522 [HAOI2011]Problem b</a></p>
<p>Problem 4:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2398">P2398 GCD SUM</a></p>
<p>Problem 5:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1829">P1829 [���Ҽ�ѵ��]Crash�����ֱ��� &#x2F; JZPTAB</a></p>
<p>Problem 6:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3327">P3327 [SDOI2015]Լ��������</a></p>
<p>Problem 7:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3768">P3768 �򵥵���ѧ��</a></p>
<p>Problem 8:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4449">P4449 ����֮ŭ��ǿ��</a></p>
<p>Problem 9:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P6810">P6810 ��MCOI-02��Convex Hull ͹��</a></p>
<p>Problem 10:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3312">P3312 [SDOI2014]����</a></p>
<p>Problem 11:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3704">P3704 [SDOI2017]���ֱ���</a></p>
<p>Problem 12:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P8570">P8570 [JRKSJ R6] ǣ��������</a></p>
<p>Problem 13:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P6156">P6156 ����</a></p>
<p>Problem 14:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4240">P4240 ����֮��Ŀ���</a></p>
<p>Problem 15:<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5221">P5221 Product</a></p>
<h2 id="�౶����"><a href="#�౶����" class="headerlink" title="�౶����"></a>�౶����</h2><p>Problem 1:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4450">P4450 ˫����</a></li>
</ul>
<p>Problem 2:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2568">P2568 GCD</a></li>
</ul>
<p>Problem 4:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1390">P1390 ��Լ���ĺ�</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1447">P1447 [NOI2010] �����ɼ�</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/UVA11417">UVA11417 GCD</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/UVA11424">UVA11424 GCD - Extreme (I)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/UVA11426">UVA11426 ��������ް棩 GCD - Extreme (II)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/SP3871">SP3871 GCDEX - GCD Extreme</a></li>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/SP19985">SP19985 GCDEX2 - GCD Extreme (hard)</a></li>
</ul>
<h2 id="����-9"><a href="#����-9" class="headerlink" title="����"></a>����</h2><p>���벢��ȫ�� <code>Accepted</code>����ΪΪ��<strong>��ֹ����ӷ��</strong>������ɾȥ��<strong>ȡģ�Ͷ������</strong>������˼·�ʹ������ϲ�������⡣������ʷ�������˲���д����ġ�</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        
                            <li title="0" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                        
                            <li title="1" data-url="http://link.hhtjim.com/163/425570952.mp3"></li>
                        
                    
                </ul>
            
        </div>
        
        
    <div id="gitalk-container" class="comment link"
		data-enable="false"
        data-ae="false"
        data-ci=""
        data-cs=""
        data-r=""
        data-o=""
        data-a=""
        data-d="false"
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>


<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/typed.js"></script>
<script src="/js/diaspora.js"></script>


<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">


<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>






</html>
